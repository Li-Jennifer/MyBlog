---
title: get post
date: 2022-09-06 19:03:40
permalink: /pages/44e2f6/
categories:
  - 基础
  - 爬虫
tags:
  - 
author: 
  name: Jennifer
  link: https://github.com/Li-Jennifer
---
# 编码解码
字节->字符串：解码 decode
字符串->字节：编码 encode
# get post
## 1.get：urllib.parse.quote() 单个参数
```python
import urllib.request
import urllib.parse
url = 'https://www.baidu.com/s?wd='

# 请求对象的定制为了解决反爬的第一种手段
headers = {
'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:103.0) Gecko/20100101 Firefox/103.0'
}

# 将周杰伦三个字变成unicode编码的格式
# 我们需要依赖于urllib.parse
name = urllib.parse.quote('周杰伦')
url = url + name

# 请求对象的定制
request = urllib.request.Request(url=url,headers=headers)

# 模拟浏览器向服务器发送请求
response = urllib.request.urlopen(request)

# 获取响应的内容
content = response.read().decode('utf-8')

# 打印数据
print(content)

```
## 2.get: urllib.parse.urlencode() 多个参数
```python
import urllib.request
import urllib.parse
base_url = 'https://www.baidu.com/s?'

data = {
'wd':'周杰伦',
'sex':'男',
'location':'中国台湾省'
}

new_data = urllib.parse.urlencode(data)

# 请求资源路径
url = base_url + new_data

headers = {
'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:103.0) Gecko/20100101 Firefox/103.0'
}
  
# 请求对象的定制
request = urllib.request.Request(url=url,headers=headers)

# 模拟浏览器向服务器发送请求
response = urllib.request.urlopen(request)

```
## 3.post
```python
url = 'https://fanyi.baidu.com/sug'
headers = {
    'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:103.0) Gecko/20100101 Firefox/103.0'
}
  
data = {
'kw':'spider'
}

# post请求的参数 必须要进行编码
data = urllib.parse.urlencode(data).encode('utf-8')

# post的请求的参数 放在请求对象定制的参数data中
request = urllib.request.Request(url=url,data=data,headers=headers)

# 模拟浏览器向服务器发送请求
response = urllib.request.urlopen(request)

# 获取响应的数据
content = response.read().decode('utf-8')

# 字符串--》json对象
import json
obj = json.loads(content)
print(obj)

# post请求方式的参数 必须编码 data = urllib.parse.urlencode(data)
# 编码之后 必须调用encode方法 data = urllib.parse.urlencode(data).encode('utf-8')
# 参数是放在请求对象定制的方法中 request = urllib.request.Request(url=url,data=data,headers=headers)
```
## 4. ajax post
```python
import urllib.request
import urllib.parse

def create_request(page):
    base_url = 'https://movie.douban.com/j/chart/top_list?type=5&interval_id=100%3A90&action=&'
    data = {
    'start':(page - 1) * 20,
    'limit':20
    }

    data = urllib.parse.urlencode(data)
    url = base_url + data
    headers = {
    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36'
    }
    request = urllib.request.Request(url = url,headers = headers)
    return request

  

def get_content(request):
    response = urllib.request.urlopen(request)
    content = response.read().decode('utf-8')
        return content

def down_load(page,content):
    with open('douban_' + str(page) + '.json','w',encoding='utf-8')as fp:
        fp.write(content)


# 程序的入口
if __name__ == '__main__':
    start_page = int(input('请输入起始的页码'))
    end_page = int(input('请输入结束的页面'))
    for page in range(start_page,end_page+1):

    # 每一页都有自己的请求对象的定制
    request = create_request(page)
    # 获取响应的数
    content = get_content(request)
    # 下载
    down_load(page,content)
```
