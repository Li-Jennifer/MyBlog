<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>python组件 | Jennifer&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/logo.jpg">
    <meta name="description" content="个人技术博客">
    <meta name="keywords" content="个人技术博客">
    <meta name="theme-color" content="#42b983">
    
    <link rel="preload" href="/assets/css/0.styles.600d868b.css" as="style"><link rel="preload" href="/assets/js/app.55777c8e.js" as="script"><link rel="preload" href="/assets/js/2.f1cfd21b.js" as="script"><link rel="preload" href="/assets/js/45.d04ed2a7.js" as="script"><link rel="prefetch" href="/assets/js/10.4e0b0583.js"><link rel="prefetch" href="/assets/js/11.eb1f9ae5.js"><link rel="prefetch" href="/assets/js/12.5aec33a5.js"><link rel="prefetch" href="/assets/js/13.88fb4c3d.js"><link rel="prefetch" href="/assets/js/14.597f89bb.js"><link rel="prefetch" href="/assets/js/15.70a066d0.js"><link rel="prefetch" href="/assets/js/16.6a5b7682.js"><link rel="prefetch" href="/assets/js/17.eb2acf52.js"><link rel="prefetch" href="/assets/js/18.d73410e8.js"><link rel="prefetch" href="/assets/js/19.4b63f741.js"><link rel="prefetch" href="/assets/js/20.1c27a508.js"><link rel="prefetch" href="/assets/js/21.645ab295.js"><link rel="prefetch" href="/assets/js/22.71ff58f1.js"><link rel="prefetch" href="/assets/js/23.1ecb5661.js"><link rel="prefetch" href="/assets/js/24.a7fa193b.js"><link rel="prefetch" href="/assets/js/25.d9298fa6.js"><link rel="prefetch" href="/assets/js/26.da207ab0.js"><link rel="prefetch" href="/assets/js/27.3215ff6e.js"><link rel="prefetch" href="/assets/js/28.daa51aa3.js"><link rel="prefetch" href="/assets/js/29.64c0466e.js"><link rel="prefetch" href="/assets/js/3.00660cd2.js"><link rel="prefetch" href="/assets/js/30.0b067aea.js"><link rel="prefetch" href="/assets/js/31.c401f207.js"><link rel="prefetch" href="/assets/js/32.21499ae6.js"><link rel="prefetch" href="/assets/js/33.ce8a6295.js"><link rel="prefetch" href="/assets/js/34.d6fe94b6.js"><link rel="prefetch" href="/assets/js/35.75a276fd.js"><link rel="prefetch" href="/assets/js/36.cff468fe.js"><link rel="prefetch" href="/assets/js/37.48024518.js"><link rel="prefetch" href="/assets/js/38.73f8422c.js"><link rel="prefetch" href="/assets/js/39.25a33119.js"><link rel="prefetch" href="/assets/js/4.fc2e6e49.js"><link rel="prefetch" href="/assets/js/40.95dfb2ec.js"><link rel="prefetch" href="/assets/js/41.7b63b2ee.js"><link rel="prefetch" href="/assets/js/42.158e6c89.js"><link rel="prefetch" href="/assets/js/43.9f0ff699.js"><link rel="prefetch" href="/assets/js/44.4c1efbad.js"><link rel="prefetch" href="/assets/js/46.3fd3551a.js"><link rel="prefetch" href="/assets/js/47.7bafa4ec.js"><link rel="prefetch" href="/assets/js/48.9ae62e62.js"><link rel="prefetch" href="/assets/js/49.2a7441b7.js"><link rel="prefetch" href="/assets/js/5.94100015.js"><link rel="prefetch" href="/assets/js/50.1a6f644b.js"><link rel="prefetch" href="/assets/js/51.328ac836.js"><link rel="prefetch" href="/assets/js/52.8b96407d.js"><link rel="prefetch" href="/assets/js/53.cd36ede8.js"><link rel="prefetch" href="/assets/js/54.558a96f9.js"><link rel="prefetch" href="/assets/js/55.99d0fc72.js"><link rel="prefetch" href="/assets/js/56.876df14f.js"><link rel="prefetch" href="/assets/js/57.437d3685.js"><link rel="prefetch" href="/assets/js/58.19ee804e.js"><link rel="prefetch" href="/assets/js/59.99876e69.js"><link rel="prefetch" href="/assets/js/6.ad6ca8d3.js"><link rel="prefetch" href="/assets/js/60.e0e46ca9.js"><link rel="prefetch" href="/assets/js/61.77947d6b.js"><link rel="prefetch" href="/assets/js/62.d3214dd2.js"><link rel="prefetch" href="/assets/js/63.d224bc8b.js"><link rel="prefetch" href="/assets/js/64.7e9fd283.js"><link rel="prefetch" href="/assets/js/65.c4f83c1a.js"><link rel="prefetch" href="/assets/js/66.01feebc1.js"><link rel="prefetch" href="/assets/js/67.fe1476e2.js"><link rel="prefetch" href="/assets/js/68.4d8eb457.js"><link rel="prefetch" href="/assets/js/69.28882346.js"><link rel="prefetch" href="/assets/js/7.6f5c20a8.js"><link rel="prefetch" href="/assets/js/70.974894cd.js"><link rel="prefetch" href="/assets/js/71.a4c9c68b.js"><link rel="prefetch" href="/assets/js/72.07ef9b4f.js"><link rel="prefetch" href="/assets/js/73.3d56f125.js"><link rel="prefetch" href="/assets/js/74.da4572e0.js"><link rel="prefetch" href="/assets/js/75.8330a59d.js"><link rel="prefetch" href="/assets/js/76.83f1116f.js"><link rel="prefetch" href="/assets/js/77.d352d68a.js"><link rel="prefetch" href="/assets/js/78.04097fda.js"><link rel="prefetch" href="/assets/js/79.9833a012.js"><link rel="prefetch" href="/assets/js/8.00174968.js"><link rel="prefetch" href="/assets/js/80.829ffb9d.js"><link rel="prefetch" href="/assets/js/81.0f3cf71c.js"><link rel="prefetch" href="/assets/js/82.f347bbd0.js"><link rel="prefetch" href="/assets/js/83.8ab1aa58.js"><link rel="prefetch" href="/assets/js/84.713ae1ef.js"><link rel="prefetch" href="/assets/js/85.b526796a.js"><link rel="prefetch" href="/assets/js/86.6fd67398.js"><link rel="prefetch" href="/assets/js/87.94520354.js"><link rel="prefetch" href="/assets/js/9.828a3977.js">
    <link rel="stylesheet" href="/assets/css/0.styles.600d868b.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="Jennifer's blog" class="logo"> <span class="site-name can-hide">Jennifer's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🥝索引" class="dropdown-title"><a href="/archives/" class="link-title">🥝索引</a> <span class="title" style="display:none;">🥝索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.jpg"> <div class="blogger-info"><h3>Jennifer</h3> <span>我们的目标是星辰大海</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🥝索引" class="dropdown-title"><a href="/archives/" class="link-title">🥝索引</a> <span class="title" style="display:none;">🥝索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>试题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>collection</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/fb8510/" aria-current="page" class="active sidebar-link">python组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_1-生成6位数字随机验证码" class="sidebar-link">1. 生成6位数字随机验证码</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_2-md5加密" class="sidebar-link">2.md5加密</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_3-生成唯一token" class="sidebar-link">3. 生成唯一token</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_4、发送手机验证码" class="sidebar-link">4、发送手机验证码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/fb8510/#实现逻辑" class="sidebar-link">实现逻辑</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_5、生成二维码" class="sidebar-link">5、生成二维码</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_6-微信群发" class="sidebar-link">6.微信群发</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_7、微信自动回复" class="sidebar-link">7、微信自动回复</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_8、提取django中model中的字段名变成字典、列表" class="sidebar-link">8、提取Django中model中的字段名变成字典、列表</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_9、数据库中给表创建数据" class="sidebar-link">9、数据库中给表创建数据</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_10-捕捉异常" class="sidebar-link">10.捕捉异常</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_11、获取当前时间" class="sidebar-link">11、获取当前时间</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_12、订单编号" class="sidebar-link">12、订单编号</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_13、mysql自动填写当前时间" class="sidebar-link">13、mysql自动填写当前时间</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_14、drf动态过滤查询" class="sidebar-link">14、drf动态过滤查询</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_15、linux后台运行python程序" class="sidebar-link">15、linux后台运行python程序</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_16、追加外键" class="sidebar-link">16、追加外键</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_17、写-读csv文件-查看是否存在-若存在就从csv中删除" class="sidebar-link">17、写/读CSV文件，查看是否存在，若存在就从csv中删除</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_18、django中从request获取访问路径" class="sidebar-link">18、django中从request获取访问路径</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_19、django收集静态文件" class="sidebar-link">19、Django收集静态文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_20、xadmin插件" class="sidebar-link">20、xadmin插件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_21、uwsgi自动重启" class="sidebar-link">21、uwsgi自动重启</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_22、谷歌浏览器快捷键" class="sidebar-link">22、谷歌浏览器快捷键</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_23、git克隆分支" class="sidebar-link">23、git克隆分支</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_24、mysql更新语句、新增列、删除列" class="sidebar-link">24、mysql更新语句、新增列、删除列</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_25、删除指定格式的文件" class="sidebar-link">25、删除指定格式的文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_26、计算文件总数" class="sidebar-link">26、计算文件总数</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_27、计算文件夹大小" class="sidebar-link">27、计算文件夹大小</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_28、django实现jsonp跨域" class="sidebar-link">28、Django实现jsonp跨域</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_29、微信获取用户信息" class="sidebar-link">29、微信获取用户信息</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_30、uwsgi初始配置问题" class="sidebar-link">30、uwsgi初始配置问题</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_31、django中drf序列化" class="sidebar-link">31、django中drf序列化</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_32、第三方库" class="sidebar-link">32、第三方库</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_33、requests请求https携带ca证书" class="sidebar-link">33、requests请求https携带CA证书</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_34、django创建缓存命令" class="sidebar-link">34、django创建缓存命令</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_35、django-更改超级用户密码" class="sidebar-link">35、Django 更改超级用户密码</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_36、restframe使用缓存" class="sidebar-link">36、restframe使用缓存</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_37、数据库" class="sidebar-link">37、数据库</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_38、linux常用命令" class="sidebar-link">38、linux常用命令</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_39、xadmin禁止增加、删除" class="sidebar-link">39、xadmin禁止增加、删除</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_40、时间格式字符串相减" class="sidebar-link">40、时间格式字符串相减</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_41、显示循环进度条" class="sidebar-link">41、显示循环进度条</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_42、把列表中的字典转成csv文件" class="sidebar-link">42、把列表中的字典转成csv文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_43、windows添加右键新建markdown文件" class="sidebar-link">43、windows添加右键新建MarkDown文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_44、redis设置值定时过期" class="sidebar-link">44、redis设置值定时过期</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_45、linux根据端口杀进程" class="sidebar-link">45、linux根据端口杀进程</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_46、监控linux网络流量" class="sidebar-link">46、监控linux网络流量</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_47、win10添加右键打开cmd" class="sidebar-link">47、win10添加右键打开cmd</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_48、xadmin后台无法显示下拉框完整内容" class="sidebar-link">48、xadmin后台无法显示下拉框完整内容</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_49、xadmin单点登录" class="sidebar-link">49、xadmin单点登录</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_50、django-restful-多个models数据表序列化合并返回-一次请求返回多个序列化器数据" class="sidebar-link">50、Django restful 多个models数据表序列化合并返回（一次请求返回多个序列化器数据）</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_51、-django序列化器返回外键关联数据" class="sidebar-link">51、 Django序列化器返回外键关联数据</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_52、python-django通过user-agent判断请求来源是微信扫一扫或者是支付宝扫一扫" class="sidebar-link">52、python Django通过User Agent判断请求来源是微信扫一扫或者是支付宝扫一扫</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_53、xadmin后台集成-导入-插件-导入excel文件" class="sidebar-link">53、xadmin后台集成’导入‘插件，导入excel文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_54、django中查找今天进账金额" class="sidebar-link">54、Django中查找今天进账金额</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_55、判断是什么系统" class="sidebar-link">55、判断是什么系统</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_56、sql查询" class="sidebar-link">56、sql查询</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_57、-xadmin后台删除数据出现错误" class="sidebar-link">57、 xadmin后台删除数据出现错误</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_58、xdamin限制用户点击" class="sidebar-link">58、xdamin限制用户点击</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_59、获取公众号关注url" class="sidebar-link">59、获取公众号关注url</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_60、xadmin后台用户操作表权限" class="sidebar-link">60、xadmin后台用户操作表权限</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_61、使用nginx部署项目" class="sidebar-link">61、使用nginx部署项目</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_62、xadmin后台发送邮件找回密码" class="sidebar-link">62、xadmin后台发送邮件找回密码</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_63、xadmin外键下拉框添加过滤" class="sidebar-link">63、xadmin外键下拉框添加过滤</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_64、xadmin即时编辑器去掉空标签" class="sidebar-link">64、xadmin即时编辑器去掉空标签</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_65、用户增加的小组件-让其他用户可见" class="sidebar-link">65、用户增加的小组件，让其他用户可见</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_66、pip-install-uwsgi出错" class="sidebar-link">66、pip install uwsgi出错</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_66、xadmin后台加载数据慢-解决方案" class="sidebar-link">66、xadmin后台加载数据慢，解决方案</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_67-、xadmin导出插件处理-增加导出勾选数据项" class="sidebar-link">67 、xadmin导出插件处理，增加导出勾选数据项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/pages/fb8510/#_1、加载js文件" class="sidebar-link">1、加载js文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/fb8510/#_2、修改export-py-后端处理下载文件" class="sidebar-link">2、修改export.py，后端处理下载文件</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_68、使用f查询更新用户重要数据" class="sidebar-link">68、使用F查询更新用户重要数据</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_69、日志输出模块" class="sidebar-link">69、日志输出模块</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_70、字典排序" class="sidebar-link">70、字典排序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/fb8510/#对列表中字典按多个键值排序" class="sidebar-link">对列表中字典按多个键值排序</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_71、时间格式与字符串互转、比较大小" class="sidebar-link">71、时间格式与字符串互转、比较大小</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_72、python把-u-开头的字符串转中文" class="sidebar-link">72、python把’\u’开头的字符串转中文</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_73、django进行数据迁移时出现no-changes-detected解决方案" class="sidebar-link">73、django进行数据迁移时出现No changes detected解决方案</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_74、ubuntu下载文件到windows桌面" class="sidebar-link">74、ubuntu下载文件到windows桌面</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_75、git查看提交日志" class="sidebar-link">75、git查看提交日志</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_76、python翻译模块" class="sidebar-link">76、python翻译模块</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_77、python实现字符串转字典" class="sidebar-link">77、python实现字符串转字典</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_78、django-app-如何在后台显示中文名" class="sidebar-link">78、django app 如何在后台显示中文名</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_79、使用python给excel指定行添加数据" class="sidebar-link">79、使用python给Excel指定行添加数据</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_80、python中的format格式拼接字符串" class="sidebar-link">80、python中的format格式拼接字符串</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_81、数据库inner-join、full-join、left-join、union、union-all区别" class="sidebar-link">81、数据库inner join、full join、left join、union、union all区别</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_82、windows电脑查看端口使用情况" class="sidebar-link">82、windows电脑查看端口使用情况</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_83、django生成表和反向生成model" class="sidebar-link">83、Django生成表和反向生成Model</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_84、windows的hosts文件位置" class="sidebar-link">84、windows的hosts文件位置</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_85、postgresql数据库" class="sidebar-link">85、postgresql数据库</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_86、python控制台输出带颜色的文字方法" class="sidebar-link">86、python控制台输出带颜色的文字方法</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_87、控制台输出白色方框" class="sidebar-link">87、控制台输出白色方框</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_88、xadmin后台编辑多对多字段" class="sidebar-link">88、xadmin后台编辑多对多字段</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_89、django后台通过按钮显示textfield字段内容" class="sidebar-link">89、Django后台通过按钮显示TextField字段内容</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_90、前端判断上传的文件是否为图片且限制大小为300kb" class="sidebar-link">90、前端判断上传的文件是否为图片且限制大小为300kB</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_91、form表单提交前验证" class="sidebar-link">91、form表单提交前验证</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_92、有序字典" class="sidebar-link">92、有序字典</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_93、python在windows系统下实现tts-文字转语音" class="sidebar-link">93、Python在Windows系统下实现TTS（文字转语音）</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_94、定义一个简单闹钟" class="sidebar-link">94、定义一个简单闹钟</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_95、根据年月获取当月天数" class="sidebar-link">95、根据年月获取当月天数</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_96、django获取favicon-ico图标" class="sidebar-link">96、Django获取favicon.ico图标</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_97、django-静态文件配置" class="sidebar-link">97、django 静态文件配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_98、django-jsonresponse返回中文时显示unicode编码-u67e5-u8be2" class="sidebar-link">98、django JsonResponse返回中文时显示unicode编码（\u67e5\u8be2）</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_99、获取当前时间月份的首日与最后一天" class="sidebar-link">99、获取当前时间月份的首日与最后一天</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_100、xadmin后台批量操作" class="sidebar-link">100、xadmin后台批量操作</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_101、xadmin过滤器外键显示特定值-比如只能过滤自己与超级管理员定义的数据" class="sidebar-link">101、xadmin过滤器外键显示特定值（比如只能过滤自己与超级管理员定义的数据）</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_102、django中的csrf局部禁用" class="sidebar-link">102、Django中的CSRF局部禁用</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_103、使用python命令创建django项目" class="sidebar-link">103、使用python命令创建django项目</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_104、-二维列表、二维数组行求和与列求和" class="sidebar-link">104、 二维列表、二维数组行求和与列求和</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_105、获取时间字符串的月份数" class="sidebar-link">105、获取时间字符串的月份数</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_106、字符串不足补零" class="sidebar-link">106、字符串不足补零</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_107、时间戳转字符串日期" class="sidebar-link">107、时间戳转字符串日期</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_108、列表转字符串" class="sidebar-link">108、列表转字符串</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_109、pip国内镜像源" class="sidebar-link">109、pip国内镜像源</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_110、python把时间字符串转换成刚刚、1天前、3个月前、1年前" class="sidebar-link">110、python把时间字符串转换成刚刚、1天前、3个月前、1年前</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_111、django使用orm执行sql语句" class="sidebar-link">111、Django使用ORM执行sql语句</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_112、django通过变量字段获取数据" class="sidebar-link">112、Django通过变量字段获取数据</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_113、django查询变量字段、更新变量字段" class="sidebar-link">113、Django查询变量字段、更新变量字段</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_114、vue生成dist文件" class="sidebar-link">114、vue生成dist文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_115、python获取电脑磁盘、cpu、内存使用情况" class="sidebar-link">115、python获取电脑磁盘、CPU、内存使用情况</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_116、max比较字典列表" class="sidebar-link">116、max比较字典列表</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_117、django查询表的具体字段" class="sidebar-link">117、django查询表的具体字段</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_118、mysql查询数据添加自增序号" class="sidebar-link">118、MySQL查询数据添加自增序号</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_119、mysql-时间截取年月日" class="sidebar-link">119、MySQL 时间截取年月日</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_120、-列表取奇数下标值" class="sidebar-link">120、 列表取奇数下标值</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_121、列表取偶数下标值" class="sidebar-link">121、列表取偶数下标值</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_122、列表相同元素分类、分组" class="sidebar-link">122、列表相同元素分类、分组</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_123、ubuntu切换用户" class="sidebar-link">123、ubuntu切换用户</a></li><li class="sidebar-sub-header level2"><a href="/pages/fb8510/#_124、numpy二维数组获取某一列" class="sidebar-link">124、numpy二维数组获取某一列</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E6%8A%80%E6%9C%AF" title="分类" data-v-06225672>技术</a></li><li data-v-06225672><a href="/categories/?category=collection" title="分类" data-v-06225672>collection</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/Li-Jennifer" target="_blank" title="作者" class="beLink" data-v-06225672>Jennifer</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-09-06</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">python组件<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="_1-生成6位数字随机验证码"><a href="#_1-生成6位数字随机验证码" class="header-anchor">#</a> 1. 生成6位数字随机验证码</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> random
<span class="token keyword">import</span> string


<span class="token keyword">def</span> <span class="token function">num_code</span><span class="token punctuation">(</span>length<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    生成长度为length的数字随机验证码
    :param length: 验证码长度
    :return: 验证码
    &quot;&quot;&quot;</span>
    
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>digits<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_2-md5加密"><a href="#_2-md5加密" class="header-anchor">#</a> 2.md5加密</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span>  hashlib


<span class="token comment"># md5加密</span>
<span class="token keyword">def</span> <span class="token function">md5_encrypt</span><span class="token punctuation">(</span>en_str<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    使用md5二次加密生成32位的字符串
    :param en_str: 需要加密的字符串
    :return: 加密后的字符串
    &quot;&quot;&quot;</span>
   
    md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 使用MD5加密模式</span>
    md5<span class="token punctuation">.</span>update<span class="token punctuation">(</span>en_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将参数字符串传入</span>
    md5<span class="token punctuation">.</span>update<span class="token punctuation">(</span>md5<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># md5二次加密</span>
    <span class="token keyword">return</span> md5<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_3-生成唯一token"><a href="#_3-生成唯一token" class="header-anchor">#</a> 3. 生成唯一token</h2> <div class="language- extra-class"><pre><code>import uuid
import  hashlib

def only_token():
    &quot;&quot;&quot;
    使用md5加密uuid生成唯一的32位token
    :return: 加密后的字符串
    &quot;&quot;&quot;
md5 = hashlib.md5()  # 使用MD5加密模式
md5.update(str(uuid.uuid1()).encode('utf-8'))  
return md5.hexdigest()
</code></pre></div><h2 id="_4、发送手机验证码"><a href="#_4、发送手机验证码" class="header-anchor">#</a> 4、发送手机验证码</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>#验证码管理表
class AuthCode(models.Model):
    name = models.CharField(max_length=10,default=None, null=True, blank=True,verbose_name='姓名')
    phone = models.CharField(max_length=11, unique=True, verbose_name='手机号')
    code = models.CharField(max_length=6,verbose_name='验证码')
    purpose = models.IntegerField(default=0,verbose_name='用途:0-&gt;注册验证 1-&gt;找回密码 2-&gt;其它')
    sendNum = models.IntegerField(default=0,verbose_name='发送次数')
    isCanGet = models.BooleanField(default=0,verbose_name='0-&gt;可以获取,1-&gt;不可以获取')
    recentlySendTime = models.DateTimeField(auto_now_add=True,verbose_name='最近一次发送时间')
    creation_time = models.DateTimeField(auto_now=True, verbose_name='创建时间')

    class Meta:
        verbose_name = '手机验证码'
        verbose_name_plural = verbose_name

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="实现逻辑"><a href="#实现逻辑" class="header-anchor">#</a> 实现逻辑</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>import http.client
import urllib
# 使用互亿无线
host = &quot;106.ihuyi.com&quot;
sms_send_uri = &quot;/webservice/sms.php?method=Submit&quot;

# 查看用户名 登录用户中心-&gt;验证码通知短信&gt;产品总览-&gt;API接口信息-&gt;APIID
account = &quot;你的用户名&quot;
# 查看密码 登录用户中心-&gt;验证码通知短信&gt;产品总览-&gt;API接口信息-&gt;APIKEY
password = &quot;你的密码&quot;


def send_sms(text, mobile):
    text = f&quot;您的验证码是：{text}。请不要把验证码泄露给其他人。&quot;
    params = urllib.parse.urlencode(
        {'account': account, 'password': password, 'content': text, 'mobile': mobile, 'format': 'json'})
    headers = {&quot;Content-type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;Accept&quot;: &quot;text/plain&quot;}
    conn = http.client.HTTPConnection(host, port=80, timeout=30)
    conn.request(&quot;POST&quot;, sms_send_uri, params, headers)
    response = conn.getresponse()
    response_str = response.read()
    conn.close()
    return response_str


if __name__ == '__main__':
    mobile = &quot;手机号&quot;
    text = '123122'

    print(json.loads(send_sms(text, mobile).decode('utf-8')))

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="_5、生成二维码"><a href="#_5、生成二维码" class="header-anchor">#</a> 5、生成二维码</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import qrcode
import io

def maker_qrcode(url):
    &quot;&quot;&quot;
    生成二维码
    :param url: 需要生成二维码的url
    :return: 返回图片字节流
    &quot;&quot;&quot;
    image = qrcode.make(url)  # 创建二维码片

    buffer = io.BytesIO()
    # 将图片内容丢入容器
    image.save(buffer, 'png')
    # 返回容器内的字节
    return buffer.getvalue()
    
或者
from .settings import BASE_DIR

def create_qrcode(name, url):
    &quot;&quot;&quot;
    生成机器扫码支付二维码
    :param name: 图片名称
    :param url: 支付路由
    :return:
    &quot;&quot;&quot;
    img = qrcode.make(url, border=0)  # 创建二维码片
    save_path = BASE_DIR + '/' + name + '.png'
    print(save_path)
    img.save(save_path)
    return img


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="_6-微信群发"><a href="#_6-微信群发" class="header-anchor">#</a> 6.微信群发</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># coding=utf8
import itchat, time

itchat.auto_login(True)

SINCERE_WISH = u'祝%s新年快乐！'

friendList = itchat.get_friends(update=True)[35:]
count = 0

for  index,friend in enumerate(friendList):
    print(index,friend['DisplayName'],friend['NickName'])
    itchat.send(SINCERE_WISH % (friend['DisplayName']
                                or friend['NickName']), friend['UserName'])
    time.sleep(2)
    print('备注名称',friend['DisplayName'],'昵称',friend['NickName'],'用户名',friend['UserName'])

print(&quot;----end----&quot;)

&quot;&quot;&quot;
# 发送文本
itchat.send('Hello, WeChat!')
# 发送图片
itchat.send_image('my_picture.png')
# 发送视频
itchat.send_video('my_video.mov')
# 发送文件
itchat.send_file('my_file.zip')

&quot;&quot;&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_7、微信自动回复"><a href="#_7、微信自动回复" class="header-anchor">#</a> 7、微信自动回复</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># -*- coding=utf-8 -*-
import requests
import itchat
import random
#图灵机器人
#http://www.tuling123.com/member/robot/1380138/center/frame.jhtml?page=0&amp;child=0获取apikey
KEY = '你的KEY'

def get_response(msg):
    apiUrl = 'http://www.tuling123.com/openapi/api'
    data = {
        'key'    : KEY,
        'info'   : msg,
        'userid' : 'wechat-robot',
    }
    try:
        r = requests.post(apiUrl, data=data).json()
        return r.get('text')
    except:
        return

@itchat.msg_register(itchat.content.TEXT)
def tuling_reply(msg):
    defaultReply = 'I received: ' + msg['Text']
    robots=['','','']
    reply = get_response(msg['Text'])+random.choice(robots)
    return reply or defaultReply

itchat.auto_login(enableCmdQR=False)
itchat.run()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_8、提取django中model中的字段名变成字典、列表"><a href="#_8、提取django中model中的字段名变成字典、列表" class="header-anchor">#</a> 8、提取Django中model中的字段名变成字典、列表</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import re
t = &quot;&quot;&quot;
    goods_id = models.IntegerField(verbose_name='商品编号')
    label_code = models.CharField(max_length=20, verbose_name='商品标签')
&quot;&quot;&quot;
# 字典
print({k:None for k in re.findall('([a-z_A-Z]+)\s=\s',t)})
# 列表
# print([k for k in re.findall('([a-z_A-Z]+)\s=\s',t)])

输出
{'goods_id': None, 'lable_code': None}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_9、数据库中给表创建数据"><a href="#_9、数据库中给表创建数据" class="header-anchor">#</a> 9、数据库中给表创建数据</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import pymysql

def createData(dataDict,tableName):
    &quot;&quot;&quot;
    给数据表创建数据
    :param dataDict: 字典
    :param tableName: 表名
    :return: 
    &quot;&quot;&quot;
    #连接数据库
    conn = pymysql.connect(
        host='192.168.0.188', #数据库所在地址URL
        user='root', #用户名
        password='123456', #密码
        database='名称', #数据库名称
        port=3306,  #端口号
        charset='utf8'
    )
    #拿到查询游标
    cursor = conn.cursor()
    clos,value = zip(*dataDict.items())
    sql = &quot;INSERT INTO `%s`(%s) VALUES (%s)&quot; % (tableName,
                                                ','.join(clos),
                                                ','.join(['%s'] * len(value))
                                                )
    print(sql)
    cursor.execute(sql, value)
    conn.commit()
    cursor.close()
    conn.close()
    print('Done')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="_10-捕捉异常"><a href="#_10-捕捉异常" class="header-anchor">#</a> 10.捕捉异常</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>try:
    pass
except 异常类型 as e:
    pass
finally:
    pass
    
    
异常类型
Exception  全部异常
AttributeError 试图访问一个对象没有的属性，比如foo.x，但是foo没有属性x
IOError 输入/输出异常；基本上是无法打开文件
ImportError 无法引入模块或包；基本上是路径问题或名称错误
IndentationError 语法错误（的子类） ；代码没有正确对齐
IndexError 下标索引超出序列边界，比如当x只有三个元素，却试图访问x[5]
KeyError 试图访问字典里不存在的键
KeyboardInterrupt Ctrl+C被按下
NameError 使用一个还未被赋予对象的变量
SyntaxError Python代码非法，代码不能编译(个人认为这是语法错误，写错了）
TypeError 传入对象类型与要求的不符合
UnboundLocalError 试图访问一个还未被设置的局部变量，基本上是由于另有一个同名的全局变量，导致你以为正在访问它
ValueError 传入一个调用者不期望的值，即使值的类型是正确的

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_11、获取当前时间"><a href="#_11、获取当前时间" class="header-anchor">#</a> 11、获取当前时间</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import datetime

current_time = str(datetime.datetime.now())[:19]
print(current_time)

输出格式如：2018-10-20 10:01:43
local_time = time.strftime('%Y%m%d%H%M%S', time.localtime(time.time()))
print(local_time)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_12、订单编号"><a href="#_12、订单编号" class="header-anchor">#</a> 12、订单编号</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>from random import Random
import time

def random_str(randomlength=8):
    str = ''
    chars = 'AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789'
    length = len(chars) - 1
    random = Random()
    for i in range(randomlength):
        str+=chars[random.randint(0, length)]
    return str

def order_num():
    &quot;&quot;&quot;
    生成付款订单号
    :return:
    &quot;&quot;&quot;
    local_time = time.strftime('%Y%m%d%H%M%S', time.localtime(time.time()))
    result = local_time + random_str(5)
    return result


print(order_num())
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_13、mysql自动填写当前时间"><a href="#_13、mysql自动填写当前时间" class="header-anchor">#</a> 13、mysql自动填写当前时间</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>CURRENT_TIMESTAMP
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20190312172747658.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>为表添加索引

ALTER table tableName ADD INDEX indexName(columnName)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_14、drf动态过滤查询"><a href="#_14、drf动态过滤查询" class="header-anchor">#</a> 14、drf动态过滤查询</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># page.py

from rest_framework.pagination import PageNumberPagination


class UserPagination(PageNumberPagination):
    &quot;&quot;&quot;用户分页器&quot;&quot;&quot;
    page_size = 10  # 默认的页面数据数量
    page_query_param = 'page'  # 定制取数据页码key 
    page_size_query_param = 'page_size'  # 默认取数据页码key 
    max_page_size = 15   # 数据每页取值的最大上限



# serializers.py

from rest_framework import serializers

from user.models import UserInfo

class UserSerializers(serializers.ModelSerializer):
    &quot;&quot;&quot;用户收货地址&quot;&quot;&quot;

    class Meta:
        model = UserInfo
	    # 所有字段
        #fields = '__all__'
        fields = ['name', 'code', 'title',  'province', 'city',
                    'quxian', 'address', 'code__gte', 'code__lte']
        # 显示外键
        depth = 2


# views.py
class MachineViews(APIView):
    def get(self, request, *args, **kwargs):
        # 从前端获取出来的过滤参数，解析成字典传进filter()函数中
        # 动态过滤，
        kwargs = {}
        # 表中的字段名
        columns = ['name', 'code', 'title',  'province', 'city',
                    'quxian', 'address', 'code__gte', 'code__lte']
        for k, v in request.query_params.items():
            if k not in columns:
                return Response('参数不对', status=status.HTTP_400_BAD_REQUEST)
			if v:
            	kwargs[k] = v

        users = UserInfo.objects.filter(**kwargs)
        page = UserPagination()
        page_goods_list = page.paginate_queryset(users, self.request, self)
        ser = UserSerializers(page_goods_list, many=True)
        return page.get_paginated_response(ser.data)
        

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h2 id="_15、linux后台运行python程序"><a href="#_15、linux后台运行python程序" class="header-anchor">#</a> 15、linux后台运行python程序</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>nohup /home/project_venv/user/bin/python3 -u /home/user/user_server.py &gt;&gt; /home/user/user.log 2&gt;&amp;1 &amp;   

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_16、追加外键"><a href="#_16、追加外键" class="header-anchor">#</a> 16、追加外键</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>ALTER TABLE tb_commentPhoto ADD CONSTRAINT FK_comment_phone
FOREIGN KEY tb_goodsComment(id) REFERENCES tb_commentPhoto(comment_id);

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_17、写-读csv文件-查看是否存在-若存在就从csv中删除"><a href="#_17、写-读csv文件-查看是否存在-若存在就从csv中删除" class="header-anchor">#</a> 17、写/读CSV文件，查看是否存在，若存在就从csv中删除</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import csv
import random
import string


def create_invite_code(random_code_pool=None, length=6, num=10, is_append=False):
    &quot;&quot;&quot;
    创建随机邀请码,并写入txt文件
    :param: random_code_pool 随机邀请码
    :param: length 邀请码长度
    :param: num 邀请码个数
    :param: is_append True追加,False 覆盖
    :return:
    &quot;&quot;&quot;
    if not random_code_pool:
        code_pool = string.ascii_uppercase + string.digits
        random_code_pool = []
        for i in range(num):
            s = ''
            for _ in range(length):
                s += random.choice(code_pool)
            if s and s not in random_code_pool:
                random_code_pool.append(s)

    # 写入方法。是追加还是覆盖
    write_method = 'a+' if is_append else 'w'
    # 写入文件
    with open('./invite_code.csv', write_method, newline='') as f:
        writer = csv.writer(f)
        for rowData in random_code_pool:
            # 按行写入
            writer.writerow((rowData,))


def check_invite_code(code):
    &quot;&quot;&quot;
    查看邀请码是否存在txt文件中，
    若存在就返回True，并在txt文件中删除
    若不存在就返回False
    :param code:
    :return:
    &quot;&quot;&quot;
    code_pool = []
    with open('./invite_code.csv', 'r', encoding='utf-8',errors='ignore') as f:
        allFileInfo = csv.reader(f)
        for row in allFileInfo:
            code_pool.append(row[0])

    if code in code_pool:
        # 删除查询的code
        code_pool.pop(code_pool.index(code))

        # 重新写入文件
        create_invite_code(code_pool,is_append=False)
        return True
    return False


if __name__ == '__main__':
    # create_invite_code(length=9,num=100)
    print(check_invite_code('WJ4PSTJG2'))


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h2 id="_18、django中从request获取访问路径"><a href="#_18、django中从request获取访问路径" class="header-anchor">#</a> 18、django中从request获取访问路径</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>print('获取相对路径', request.get_full_path())
print('获取绝对路径', request.build_absolute_uri())
print(request.build_absolute_uri('?'))
print(request.build_absolute_uri('/')[:-1].strip(&quot;/&quot;))
print(request.build_absolute_uri('/').strip(&quot;/&quot;))
print(request.build_absolute_uri('/'))
print('----------')
print(request.META['HTTP_HOST'])
print(request.META['PATH_INFO'])
print(request.META['QUERY_STRING'])
iphost = request.META.get('REMOTE_ADDR', '')  # 获取访问来源IP


# 输出如：
获取相对路径 /QRcode/?d=1
获取绝对路径 http://127.0.0.1:8000/QRcode/?d=1
http://127.0.0.1:8000/QRcode/
http://127.0.0.1:8000
http://127.0.0.1:8000
http://127.0.0.1:8000/
----------
127.0.0.1:8000
/QRcode/
d=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_19、django收集静态文件"><a href="#_19、django收集静态文件" class="header-anchor">#</a> 19、Django收集静态文件</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>先在项目根目录下创建一个static文件夹
然后在settings.py中设置
STATIC_ROOT = os.path.join(BASE_DIR, 'static')
最后执行下面的命令：
python manage.py collectstatic
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_20、xadmin插件"><a href="#_20、xadmin插件" class="header-anchor">#</a> 20、xadmin插件</h2> <p>https://www.cnblogs.com/lanqie/p/8340215.html</p> <h2 id="_21、uwsgi自动重启"><a href="#_21、uwsgi自动重启" class="header-anchor">#</a> 21、uwsgi自动重启</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>[uwsgi]
# 使用nginx连接时 使用
socket=0.0.0.0:2019
# 直接作为web服务器使用
#http=0.0.0.1:8000
# 配置工程目录
chdir=/home/user
# 配置项目的wsgi目录。相对于工程目录
wsgi-file=user/wsgi.py
virtualenv=/home/project_venv/user
#配置进程，线程信息
processes=1
threads=1
enable-threads=True
master=True
pidfile=uwsgi.pid
daemonize=uwsgi.log
#启动uwsgi的用户名和用户组
uid=root
gid=root
#uwsgi自动重启
py-autoreload=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_22、谷歌浏览器快捷键"><a href="#_22、谷歌浏览器快捷键" class="header-anchor">#</a> 22、谷歌浏览器快捷键</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>浏览器缓存

Ctrl+Shift+Del  清除Google浏览器缓存的快捷键

Ctrl+Shift+R  重新加载当前网页而不使用缓存内容

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_23、git克隆分支"><a href="#_23、git克隆分支" class="header-anchor">#</a> 23、git克隆分支</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>git clone -b dev 地址 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_24、mysql更新语句、新增列、删除列"><a href="#_24、mysql更新语句、新增列、删除列" class="header-anchor">#</a> 24、mysql更新语句、新增列、删除列</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>update user set name='张三' where id=111
# 删除
DELETE FROM table_name [WHERE Clause]

# 增加字段
alter table 表名 add column 列名 类型;
# 删除字段
alter table 表名 dropcolumn 列名 ;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_25、删除指定格式的文件"><a href="#_25、删除指定格式的文件" class="header-anchor">#</a> 25、删除指定格式的文件</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import os
import re


def remove_specified_format_file(file_dir, format_name):
    &quot;&quot;&quot;
    删除指定格式的文件
    :param file_dir: 文件根目录
    :param format_name: 格式
    :return:
    &quot;&quot;&quot;
    for root, dirs, files in os.walk(file_dir):
        # print(root) #当前目录路径
        # print(dirs) #当前路径下所有子目录
        # print(files) #当前路径下所有非目录子文件
        for file in files:
            if re.match(format_name, file):
                print(os.path.join(root, file))
                os.remove(os.path.join(root, file))


remove_specified_format_file(r'D:\学习\LDC\java', r'\._*')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_26、计算文件总数"><a href="#_26、计算文件总数" class="header-anchor">#</a> 26、计算文件总数</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import os


def file_count(file_dir):
    &quot;&quot;&quot;
    
    :param file_dir: 文件根目录
    :return:
    &quot;&quot;&quot;
    count = 0
    for root, dirs, files in os.walk(file_dir):
        # print(root) #当前目录路径
        # print(dirs) #当前路径下所有子目录
        # print(files) #当前路径下所有非目录子文件
        count += len(files)
    return count


print(file_count(r'D:\学习\LDC\java\Java学习\newEstore\estore\js'))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_27、计算文件夹大小"><a href="#_27、计算文件夹大小" class="header-anchor">#</a> 27、计算文件夹大小</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import os

def file_size(file_dir):
    &quot;&quot;&quot;
    删除指定格式的文件
    :param file_dir: 文件根目录
    :return:
    &quot;&quot;&quot;
    size = 0
    for root, dirs, files in os.walk(file_dir):
        # print(root) #当前目录路径
        # print(dirs) #当前路径下所有子目录
        # print(files) #当前路径下所有非目录子文件
        for file in files:
            size += os.path.getsize(os.path.join(root, file))
	# M为单位
    return size / 1024 / 1024


file_name = r'D:\学习'
print(file_size(file_name))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="_28、django实现jsonp跨域"><a href="#_28、django实现jsonp跨域" class="header-anchor">#</a> 28、Django实现jsonp跨域</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># html
$.ajax({
                    url: '请求路由',
                    type: 'GET',
                    dataType: 'JSONP',
                    data:{
                      code: 'yes',
                    },
                    jsonp: 'callback',
                    success: function(res) {
                       var selectData = $.parseJSON(res);
                       alert(selectData);
                    },
                    error: function(err) {

                    }
                })

# views.py
def get(self, request, *args, **kwargs):
        code = request.GET.get('code', '')
        # 跨域请求
        callback = request.GET.get('callback', '')
        return HttpResponse(&quot;%s('%s')&quot; % (callback, json.dumps({'code': code})), status=status.HTTP_200_OK)
                    
cors解决跨域

https://www.cnblogs.com/wxiaoyu/p/9578848.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="_29、微信获取用户信息"><a href="#_29、微信获取用户信息" class="header-anchor">#</a> 29、微信获取用户信息</h2> <p>参考：https://blog.csdn.net/weixin_39735923/article/details/79202563</p> <h2 id="_30、uwsgi初始配置问题"><a href="#_30、uwsgi初始配置问题" class="header-anchor">#</a> 30、uwsgi初始配置问题</h2> <p>https://blog.csdn.net/weixin_39735923/article/details/79202563</p> <h2 id="_31、django中drf序列化"><a href="#_31、django中drf序列化" class="header-anchor">#</a> 31、django中drf序列化</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># 序列化器
class MsgSerializers(serializers.ModelSerializer):
    addtime = serializers.DateTimeField(read_only=True, format=&quot;%Y-%m-%d %H:%M:%S&quot;)
    hasread = serializers.CharField(source='get_hasread_display')
    msgtype = serializers.CharField(source='get_msgtype_display')
    class Meta:
        model = MallMsg
        # 可以混合使用
        fields = '__all__'  # '__all__' 所有字段
        # 数据库层级控制（序列化链表操作）
        # depth = 1  # 外键层级


#分页器
from rest_framework.pagination import PageNumberPagination


class MyLimitOffsetPagination(PageNumberPagination):

    page_size = 3  # 默认的页面数据数量
    page_query_param = 'page'  # 定制取数据页码key ？
    page_size_query_param = 'page_size'  # 默认取数据页码key &amp;
    max_page_size = 15  # 数据每页取值的最大上限
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_32、第三方库"><a href="#_32、第三方库" class="header-anchor">#</a> 32、第三方库</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>安装openssl
 pip3 install pyOpenSSL
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_33、requests请求https携带ca证书"><a href="#_33、requests请求https携带ca证书" class="header-anchor">#</a> 33、requests请求https携带CA证书</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import OpenSSL
import requests
import urllib3.contrib.pyopenssl

urllib3.contrib.pyopenssl.inject_into_urllib3()

def p12_to_pem(certname, pwd):
    &quot;&quot;&quot;
    从.p12文件中提取pem
    :param certname:
    :param pwd:
    :return:
    &quot;&quot;&quot;
    pem_name = certname + &quot;.pem&quot;
    f_pem = open(pem_name, 'wb')
    p12file = certname + &quot;.p12&quot;
    p12 = OpenSSL.crypto.load_pkcs12(open(p12file, 'rb').read(), pwd)
    f_pem.write(OpenSSL.crypto.dump_privatekey(OpenSSL.crypto.FILETYPE_PEM, p12.get_privatekey()))
    f_pem.write(OpenSSL.crypto.dump_certificate(OpenSSL.crypto.FILETYPE_PEM, p12.get_certificate()))
    ca = p12.get_ca_certificates()
    if ca is not None:
        for cert in ca:
            f_pem.write(OpenSSL.crypto.dump_certificate(OpenSSL.crypto.FILETYPE_PEM, cert))
    f_pem.close()
    return pem_name


def post_cert_request(url, data,header, certname, pwd):
    &quot;&quot;&quot;
    使用证书发起https请求
    :param url:
    :param data:
    :param certname:
    :param pwd:
    :return:
    &quot;&quot;&quot;
    if (certname != &quot;&quot;):
        cert = p12_to_pem(certname, pwd)
    else:
        cert = None
    r = requests.post(url, header=header, data=data, cert=cert)
    return r
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h2 id="_34、django创建缓存命令"><a href="#_34、django创建缓存命令" class="header-anchor">#</a> 34、django创建缓存命令</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>python manage.py createcachetable 缓存表名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_35、django-更改超级用户密码"><a href="#_35、django-更改超级用户密码" class="header-anchor">#</a> 35、Django 更改超级用户密码</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>在工程文件目录下敲入：
python manage.py shell

再在python交互界面输入：
from django.contrib.auth.models import User
user = User.objects.get(username = '用户名')
user.set_password('密码')
user.save()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_36、restframe使用缓存"><a href="#_36、restframe使用缓存" class="header-anchor">#</a> 36、restframe使用缓存</h2> <p>https://blog.csdn.net/Odyssues_lee/article/details/80872586</p> <h2 id="_37、数据库"><a href="#_37、数据库" class="header-anchor">#</a> 37、数据库</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from user  where ISNULL(code)
update user set code='111',info='微信' where ISNULL(code)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_38、linux常用命令"><a href="#_38、linux常用命令" class="header-anchor">#</a> 38、linux常用命令</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>tail -f 日志名  实时监控日志
tail -f 80_v10.log

netstat -na|grep 80  查看端口tcp连接数
netstat -na|grep 80 | wc -l 计算端口tcp连接数

ps -ef|grep python  查看有多少python程序在运行

gunzip 2015.csv.gz   # 解压
unzip 19.zip # 解压zip
wc -l 2015.csv   # 查看行数
apt install lrzsz  # 安装
sz 文件名  # 下载文件

查找文件
find / -name 文件名

匹配执行过的以find为开头的命令
history | grep find
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_39、xadmin禁止增加、删除"><a href="#_39、xadmin禁止增加、删除" class="header-anchor">#</a> 39、xadmin禁止增加、删除</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># models.py
# 用户管理
class UserManage(models.Model):
    name = models.CharField(max_length=20, verbose_name='用户名')
    phone = models.CharField(max_length=11, unique=True, verbose_name='手机号')
    code = models.CharField(max_length=11, unique=True, verbose_name='编号')
    
    user = models.ForeignKey(User, on_delete=models.CASCADE, editable=False, null=True, verbose_name='管理员')

# adminx.py
# 用户列表
class UserAdmin(object):
    list_display = [ 'code', 'phone', 'name',]
    search_fields = ['code', 'phone']
    list_filter = ['code', 'phone']
    list_editable = ['name']  # 数据即时编辑
    readonly_fields = ['code', 'phone', 'name']  # 只读字段，不能编辑
    model_icon = 'fa fa-square'
    model = UserInfo
    
    def has_delete_permission(self, *args, **kwargs):
    	# 禁止删除
        if args:
            return True
        return False
    
	def has_add_permission(self,*args,**kwargs):
		# 禁止增加
        return False
        
    def save_models(self):
    	# 用户级别设置
        self.new_obj.user = self.request.user
        flag = self.org_obj is None and 'create' or 'change'
        if flag == 'create':
        	# 对密码字段进行加密
            self.new_obj.password = encrypt_oracle(self.new_obj.password)
        elif flag == 'change':
            if 'password' in self.change_message():
                self.new_obj.password = encrypt_oracle(self.new_obj.password)
        else:
        	pass
        super().save_models()

xadmin.site.register(UserInfo, UserAdmin)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="_40、时间格式字符串相减"><a href="#_40、时间格式字符串相减" class="header-anchor">#</a> 40、时间格式字符串相减</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import datetime
import time

start = str(datetime.datetime.now())[:19]
time.sleep(60)
end = str(datetime.datetime.now())[:19]
print(start,end)
link_start = datetime.datetime.strptime(start, '%Y-%m-%d %H:%M:%S')
link_end = datetime.datetime.strptime(end, '%Y-%m-%d %H:%M:%S')
link_min = round((link_end - link_start).seconds / 60, 2)
print(link_min,'分钟')

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_41、显示循环进度条"><a href="#_41、显示循环进度条" class="header-anchor">#</a> 41、显示循环进度条</h2> <p>参考：https://blog.csdn.net/zejianli/article/details/77915751</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>from tqdm import tqdm,trange
from time import sleep
text = &quot;&quot;
for char in tqdm([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]):
    text = text + char
    sleep(1)
    
    
# 方式二
import time


def process_bar(percent, index, total,start_time, start_str='', end_str='', total_length=100):
    # 进度条
    percent_length = int(percent)
    bar = '\r' + start_str + ('\033[1;31;41m \033[0m' * percent_length + '\033[1;37;47m \033[0m' * (
                total_length - percent_length)) + f'  {round(index / total * 100, 2)}%  ' + f' {index}|{end_str}'+ f'   |已进行时间: {round(time.time() - start_time, 2)}秒'

    print(bar, end='', flush=True)


if __name__ == '__main__':
    data_set = [i for i in range(23)]
    i = 0
    start_time = time.time()
    total = len(data_set)
    end_str = '{}'.format(total)
    for data in data_set:
        time.sleep(1)
        i += 1
        process_bar(i * 100 / total, i, total, start_time, start_str='', end_str=end_str, total_length=100)

# 方式三
import sys
import time

d = [i for i in range(100)]
for i in range(len(d)):
    time.sleep(1)
    sys.stdout.write('\r&gt;&gt; Downloading  %.2f%%' % (float(i) / float(len(d)) * 100.0))
sys.stdout.flush()

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h2 id="_42、把列表中的字典转成csv文件"><a href="#_42、把列表中的字典转成csv文件" class="header-anchor">#</a> 42、把列表中的字典转成csv文件</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import pandas as pd
lists = [{'a':1,'b':2},{'a':2,'b':3}]
df = pd.DataFrame(lists)
print(df)
df.to_csv('result2.csv')

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_43、windows添加右键新建markdown文件"><a href="#_43、windows添加右键新建markdown文件" class="header-anchor">#</a> 43、windows添加右键新建MarkDown文件</h2> <p>在网上下载Typora软件安装后
1、在桌面上新建一个txt文件，输入以下内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Windows Registry Editor Version 5.00
[HKEY_CLASSES_ROOT\.md\ShellNew]
&quot;NullFile&quot;=&quot;&quot;
&quot;FileName&quot;=&quot;template.md&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2、另存为，改后缀为.reg，保存类型为.txt，编码为Unicode</p> <p><img src="https://img-blog.csdnimg.cn/20200526232015169.png" alt="在这里插入图片描述"></p> <p>3、双击运行，确定，重启电脑，此时在桌面右键就有了新建md文件</p> <h2 id="_44、redis设置值定时过期"><a href="#_44、redis设置值定时过期" class="header-anchor">#</a> 44、redis设置值定时过期</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import datetime
import redis

redis_client = redis.Redis(
    host='127.0.0.1',
    port=6379,
    db=0,
    password='123456'
)

def redis_set():
    &quot;&quot;&quot;
    redis设置值定时过期
    :return:
    &quot;&quot;&quot;
    global redis_client

    redis_client.set('name','ldc')
    now = datetime.datetime.now()
    # 设置‘name’50秒过期
    expire_time = now + datetime.timedelta(hours=0, minutes=0, seconds=50)
    redis_client.expireat('name', expire_time)


if __name__ == '__main__':
    redis_set()

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="_45、linux根据端口杀进程"><a href="#_45、linux根据端口杀进程" class="header-anchor">#</a> 45、linux根据端口杀进程</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import os


def killport(port):
    command = '''kill -9 $(netstat -nlp | grep :''' + str(port) + ''' | awk '{print $7}' | awk -F&quot;/&quot; '{ print $1 }')'''
    os.system(command)


# 开始执行
if __name__ == '__main__':
    port = 4237
    killport(port)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_46、监控linux网络流量"><a href="#_46、监控linux网络流量" class="header-anchor">#</a> 46、监控linux网络流量</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>iftop -n -N -i eth0


nethogs eth0


vim +/字符串 文件

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_47、win10添加右键打开cmd"><a href="#_47、win10添加右键打开cmd" class="header-anchor">#</a> 47、win10添加右键打开cmd</h2> <p>通过添加注册表项实现</p> <p>win + r 输入 regedit</p> <p>找到注册表位置：HKEY_CLASSES_ROOT\Directory\Background\shell\</p> <p>右键“shel”l,新建“项”，命名为“以管理员身份打开cmd”，</p> <p>右键“以管理员身份打开cmd”，新建“DWORD(32位)值”，命名为&quot;ShowBasedOnVelocityId&quot;,值为“639bc8”</p> <p>右键“以管理员身份打开cmd”，新建“项”，命名为“command”</p> <p>右键“command”，点击“默认”，点击“修改”，填写数值为 cmd.exe /s /k pushd “%V”</p> <h2 id="_48、xadmin后台无法显示下拉框完整内容"><a href="#_48、xadmin后台无法显示下拉框完整内容" class="header-anchor">#</a> 48、xadmin后台无法显示下拉框完整内容</h2> <p>解决方案 在根目录中找到/static/xadmin/vendor/selectize/selectize.bootstrap3.css
在331行后加入 position: static;</p> <p><img src="https://img-blog.csdnimg.cn/20190704184201572.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h2 id="_49、xadmin单点登录"><a href="#_49、xadmin单点登录" class="header-anchor">#</a> 49、xadmin单点登录</h2> <p>使用中间件实现。</p> <p>新建一个utils.py文件，存放以下代码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    from django.contrib.sessions.models import Session
    from django.db.models import Q
    from django.utils import timezone
    from django.utils.deprecation import MiddlewareMixin
    
    
    class XadminMiddleware(MiddlewareMixin):
        def process_request(self, request):
            &quot;&quot;&quot;xadmin后台单点登录&quot;&quot;&quot;
            PATH_INFO = request.META.get('PATH_INFO', '')
            if PATH_INFO and 'xadmin' in PATH_INFO:
                request.session.clear_expired()   # 清除过期的key
                session_key = request.session.session_key
                for session in Session.objects.filter(~Q(session_key=session_key), expire_date__gte=timezone.now()):
                    data = session.get_decoded()
                    if data.get('_auth_user_id', None) == str(request.user.id):
                        session.delete()

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>然后在urls.py中设置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    urlpatterns = [
    ...
    re_path('^xadmin/', xadmin.site.urls),
    ...
    ]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>然后在settings.py中注册中间件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    MIDDLEWARE = [
    ...
    
    'utils.xadminauth.XadminMiddleware',
    ...
    ]
	SESSION_COOKIE_AGE = 1209600  # 设置过期时间
    SESSION_SAVE_EVERY_REQUEST = Ture  # 每次请求都更新

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>【参考】 https://blog.csdn.net/Python_anning</p> <h2 id="_50、django-restful-多个models数据表序列化合并返回-一次请求返回多个序列化器数据"><a href="#_50、django-restful-多个models数据表序列化合并返回-一次请求返回多个序列化器数据" class="header-anchor">#</a> 50、Django restful 多个models数据表序列化合并返回（一次请求返回多个序列化器数据）</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># 导入第三方包
pip install django-crispy-forms==1.7.2

# 在settings.py中添加应用
INSTALLED_APPS = [
...
'drf_multiple_model',
'rest_framework',
...
]

# 在views.py中使用
    from drf_multiple_model.pagination import MultipleModelLimitOffsetPagination
    from drf_multiple_model.views import ObjectMultipleModelAPIView
    
    
    class LimitPagination(MultipleModelLimitOffsetPagination):
        # 多个models数据表联合查询，分页，每页限制数据10条
        default_limit = 10
        
    class StudentSerializers(serializers.ModelSerializer):
        &quot;&quot;&quot;学生表序列化器&quot;&quot;&quot;
        # merchant = MerchantSerializers()
        
        register_time = serializers.DateTimeField(read_only=True, format=&quot;%Y-%m-%d %H:%M:%S&quot;)
       
        class Meta:
            model = Student
            fields = '__all__'
    class ClassesSerializers(serializers.ModelSerializer):
        &quot;&quot;&quot;班级表序列化器&quot;&quot;&quot;
        # merchant = MerchantSerializers()
        
        add_time = serializers.DateTimeField(read_only=True, format=&quot;%Y-%m-%d %H:%M:%S&quot;)
       
        class Meta:
            model = Classes
            fields = '__all__'
    
    class SchoolSerializers(serializers.ModelSerializer):
        &quot;&quot;&quot;学校表序列化器&quot;&quot;&quot;
        # merchant = MerchantSerializers()
        
        add_time = serializers.DateTimeField(read_only=True, format=&quot;%Y-%m-%d %H:%M:%S&quot;)
       
        class Meta:
            model = School
            fields = '__all__'      
            
    
    class StudentInfo(ObjectMultipleModelAPIView):
        # 获取学生信息，班级信息，学校信息
    
        def get(self, request, *args, **kwargs):
            uid = request.GET.get('uid', '')  # 学生id
            cid = request.GET.get('cid', '')  # 班级id
            sid = request.GET.get('sid', '')  # 学校id
            
            self.querylist = [
                {'queryset': Student.objects.filter(id=uid).order_by('-id'),
                    'serializer_class':  StudentSerializers, 'label': 'student', },
                {'queryset': Classes.objects.filter(id=cid).order_by('-id'),
                    'serializer_class':  ClassesSerializers, 'label': 'classes', },
                {'queryset': School.objects.filter(id=sid).order_by('-id'),
                    'serializer_class':  SchoolSerializers, 'label': 'school', },
            ]
    
            return self.list(request, *args, **kwargs)
    
        pagination_class = LimitPagination
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h2 id="_51、-django序列化器返回外键关联数据"><a href="#_51、-django序列化器返回外键关联数据" class="header-anchor">#</a> 51、 Django序列化器返回外键关联数据</h2> <p>通过 related_name='goods_price’把两个表关联起来，当返回Goods的信息时也会返回相应的GoodsPrice信息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    class GoodsPriceSerializers(serializers.ModelSerializer):
        &quot;&quot;&quot;商品价格表序列化器&quot;&quot;&quot;
        
        class Meta:
            model = GoodsPrice
            fields = ['price']
    
    class GoodsSerializers(serializers.ModelSerializer):
        &quot;&quot;&quot;商品表序列化器&quot;&quot;&quot;
        
        goods_price = GoodsPriceSerializers(many=True, read_only=True)
    
        class Meta:
            model = Goods
            fields = ['title','goods_price']
            depth = 2
    
    class Goods(models.Model):
        &quot;&quot;&quot;商品表&quot;&quot;&quot;
        title = models.CharField(max_length=50, verbose_name='商品名称')
    
        class Meta:
            db_table = 'goods'
            verbose_name = '商品信息表'
            verbose_name_plural = verbose_name
    
        def __str__(self):
            return self.title
    
    class GoodsPrice(models.Model):
        &quot;&quot;&quot;商品价格表,通过外键关联商品信息表&quot;&quot;&quot;
    
        price = models.DecimalField(max_digits=10, decimal_places=2, default=0, verbose_name='售价')
        goods = models.ForeignKey(to='Goods', related_name='goods_price', on_delete=models.SET_NULL, blank=True, null=True,verbose_name='商品')
    
        def __str__(self):
            return str(self.price)
    
        class Meta:
            managed = True
            db_table = 'goodsPrice'
            verbose_name = '商品售价'
            verbose_name_plural = verbose_name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="_52、python-django通过user-agent判断请求来源是微信扫一扫或者是支付宝扫一扫"><a href="#_52、python-django通过user-agent判断请求来源是微信扫一扫或者是支付宝扫一扫" class="header-anchor">#</a> 52、python Django通过User Agent判断请求来源是微信扫一扫或者是支付宝扫一扫</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>    class Footest(APIView):
	    def get(self, request, *args, **kwargs):
	        # print(request.META)
	        if 'MicroMessenger' in request.META['HTTP_USER_AGENT']:
	            return Response(data={'msg': '访问来源是微信'})
	        elif 'AlipayClient' in request.META['HTTP_USER_AGENT']:
	            return Response(data={'msg': '访问来源是支付宝'})
	        else:
	            return Response(data={'msg': '访问来源是其他'})

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>User Agent中文名为用户代理，简称 UA，它是一个特殊字符串头，使得服务器能够识别客户使用的操作系统及版本、CPU 类型、浏览器及版本、浏览器渲染引擎、浏览器语言、浏览器插件等。</p> <p>浏览器的 UA 字串</p> <p>标准格式为： 浏览器标识 (操作系统标识; 加密等级标识; 浏览器语言) 渲染引擎标识 版本信息</p> <p>获取user-Agent 之后，
通过识别MicroMessenger或者AlipayClient这样的关键字应该就可以判断是微信还是支付宝
【参考文章】 https://blog.csdn.net/fly910905/article/details/82498813?utm_source=blogxgwz4</p> <h2 id="_53、xadmin后台集成-导入-插件-导入excel文件"><a href="#_53、xadmin后台集成-导入-插件-导入excel文件" class="header-anchor">#</a> 53、xadmin后台集成’导入‘插件，导入excel文件</h2> <p>效果图：</p> <p><img src="https://img-blog.csdnimg.cn/20190426190357134.png" alt="在这里插入图片描述"></p> <p>1、添加</p> <p>在虚拟环境根目录\Lib\site-packages\xadmin\plugins中添加excel.py文件</p> <p><img src="https://img-blog.csdnimg.cn/20190426190440451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <div class="language- extra-class"><pre><code>from xadmin.views import BaseAdminPlugin, ListAdminView
from django.template import loader
import xadmin

class ListExcelImportPlugin(BaseAdminPlugin):
    # 重写init_request
    import_excel = False
    def init_request(self, *args, **kwargs):
        return self.import_excel

    def block_top_toolbar(self, context, nodes):
        # 这里 xadmin/excel/model_list.top_toolbar.import.html 是自己写的html文件
      nodes.append(loader.render_to_string(&quot;xadmin/excel/model_list.top_toolbar.import.html&quot;))

xadmin.site.register_plugin(ListExcelImportPlugin, ListAdminView)
</code></pre></div><p>在虚拟环境根目录\Lib\site-packages\xadmin\plugins__init__.py中</p> <div class="language- extra-class"><pre><code>PLUGINS = (
...
    'excel',
...
)
</code></pre></div><p>2、添加html文件</p> <p><img src="https://img-blog.csdnimg.cn/20190426190455263.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>在虚拟环境根目录\Lib\site-packages\xadmin\templates\xadmin\中增加文件夹excel,在文件夹中添加model_list.top_toolbar.import.html文件</p> <div class="language- extra-class"><pre><code>    {% load i18n %}
&lt;div class=&quot;btn-group export&quot;&gt;
    &lt;a class=&quot;dropdown-toggle btn btn-default btn-sm&quot; data-toggle=&quot;dropdown&quot; href=&quot;#&quot;&gt;
        &lt;i class=&quot;icon-share&quot;&gt;&lt;/i&gt; 导入数据 &lt;span class=&quot;caret&quot;&gt;&lt;/span&gt;
    &lt;/a&gt;
    &lt;ul class=&quot;dropdown-menu&quot; role=&quot;menu&quot; aria-labelledby=&quot;dLabel&quot;&gt;
        &lt;li&gt;&lt;a data-toggle=&quot;modal&quot; data-target=&quot;#export-modal-import-excel&quot;&gt;&lt;i class=&quot;icon-circle-arrow-down&quot;&gt;&lt;/i&gt; 导入
            Excel&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div id=&quot;export-modal-import-excel&quot; class=&quot;modal fade&quot;&gt;
        &lt;div class=&quot;modal-dialog&quot;&gt;
            &lt;div class=&quot;modal-content&quot;&gt;
                &lt;form method=&quot;post&quot; action=&quot;&quot; enctype=&quot;multipart/form-data&quot;&gt;
                    &lt;!--{% csrf_token %}--&gt;
                    &lt;div class=&quot;modal-header&quot;&gt;
                        &lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-hidden=&quot;true&quot;&gt;×&lt;/button&gt;
                        &lt;h4 class=&quot;modal-title&quot;&gt;导入 Excel&lt;/h4&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;modal-body&quot;&gt;
                        &lt;input type=&quot;file&quot; onchange=&quot;fileChange(this)&quot; name=&quot;excel&quot; id=&quot;submit_upload&quot;&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;modal-footer&quot;&gt;
                        &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot; data-dismiss=&quot;modal&quot;&gt;{% trans &quot;Close&quot; %}&lt;/button&gt;
                        &lt;button class=&quot;btn btn-success&quot; type=&quot;button&quot; id=&quot;submit_upload_b&quot;&gt;&lt;i class=&quot;icon-share&quot;&gt;&lt;/i&gt; 导入
                        &lt;/button&gt;
                    &lt;/div&gt;
                &lt;/form&gt;
            &lt;/div&gt;&lt;!-- /.modal-content --&gt;
        &lt;/div&gt;&lt;!-- /.modal-dalog --&gt;
    &lt;/div&gt;&lt;!-- /.modal --&gt;

&lt;/div&gt;

&lt;script type=&quot;text/javascript&quot;&gt;
    function fileChange(target) {
        //检测上传文件的类型
        var imgName = document.all.submit_upload.value;
        var ext, idx;
        if (imgName == '') {
            document.all.submit_upload_b.disabled = true;
            alert(&quot;请选择需要上传的 xls 文件!&quot;);
            return;
        } else {
            idx = imgName.lastIndexOf(&quot;.&quot;);
            if (idx != -1) {
                ext = imgName.substr(idx + 1).toUpperCase();
                ext = ext.toLowerCase();

                if (ext != 'xls' &amp;&amp; ext != 'xlsx') {
                    document.all.submit_upload_b.disabled = true;
                    alert(&quot;只能上传 .xls 类型的文件!&quot;);
                    return;
                }
            } else {
                document.all.submit_upload_b.disabled = true;
                alert(&quot;只能上传 .xls 类型的文件!&quot;);
                return;
            }
        }
    }

    $(document).ready(function () {

        $('#submit_upload_b').click(function () {
            var form_data = new FormData();
            var file_info = $('#submit_upload')[0].files[0];
            form_data.append('file', file_info);
            form_data.append('file_source', $('.breadcrumb li').eq(1).text().trim());
            var url = window.location.protocol + '//' + window.location.host + '/importkdorderno/'
            $.ajax({
                url: url,
                type: 'POST',
                data: form_data,
                dataType: &quot;json&quot;,
                beforeSend: function (xhr) {
                    xhr.setRequestHeader(&quot;X-CSRFToken&quot;, $.getCookie(&quot;csrftoken&quot;))
                },
                processData: false,  // tell jquery not to process the data
                contentType: false, // tell jquery not to set contentType
                success: function (res) {

                    alert(res.msg);
                    window.location.reload();
                },
                error: function (err) {
                }
            });
        });
    })
&lt;/script&gt;
</code></pre></div><p>3、在views.py处理上传的excel文件</p> <div class="language- extra-class"><pre><code>import pandas as pd
from rest_framework.views import APIView

class ImportKDOrderNo(APIView):

    def post(self, request, *args, **kwargs):
        file = request.FILES.get('file')
        # read = InMemoryUploadedFile().open()
        data = pd.read_excel(file)  # 使用pandas处理excel文件
		file_source = request.POST.get('file_source', '')  # 文件来源
		
        if '订单号' and '物流单号' not in data:
            return Response(data={'msg': '文件格式有误，第一行第一列应该为【订单号】，第一行第二列应该为【物流单号】'})
        ordernos = data['订单号']
        logistics = data['物流单号']
        for i in range(len(ordernos)):
            print('订单号', ordernos[i], '物流单号', logistics[i])
          
        return Response(data={'msg': '上传成功'})
</code></pre></div><p>4、在urls.py中添加访问路由</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>from django.urls import path
from 你的应用名称 import views

app_name = '你的应用名称'

urlpatterns = [
    # 其他路由
    ...
    # 导入物流单号
    path('importkdorderno/', views.ImportKDOrderNo.as_view(), name='importkdorderno'),
]

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_54、django中查找今天进账金额"><a href="#_54、django中查找今天进账金额" class="header-anchor">#</a> 54、Django中查找今天进账金额</h2> <p>views.py</p> <div class="language- extra-class"><pre><code>from datetime import datetime
class CountFee(APIView):
	def get(self, request, *args, **kwargs):
		# 获取当前时间的年月日，然后使用聚合函数添加fee字段的值
    	year = datetime.now().year
        month = datetime.now().month
        day = datetime.now().day
        count_fees = FeeDetail.objects.filter(addtime__year=year, addtime__month=month, addtime__day=day).aggregate(Sum('fee'))
        all_fee = count_fees['fee__sum'] if count_fees['fee__sum'] else 0
        print(all_fee)
        return Response({'code': 1, 'msg': 'success', 'data': {'all_fee': all_fee}})
</code></pre></div><h2 id="_55、判断是什么系统"><a href="#_55、判断是什么系统" class="header-anchor">#</a> 55、判断是什么系统</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import platform
PlATFORM = platform.system()
if PlATFORM == &quot;Linux&quot;:
    print('linux')
else:
    print('其他') 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_56、sql查询"><a href="#_56、sql查询" class="header-anchor">#</a> 56、sql查询</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># 联合更新
update malluser set master_master_id=3 where master_id in (select a.id from (select id from  malluser where id like '15%')a) 
# 统计某字段重复数据
SELECT phone, COUNT(*) AS sumCount FROM malluser GROUP BY phone HAVING sumCount &gt; 1;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_57、-xadmin后台删除数据出现错误"><a href="#_57、-xadmin后台删除数据出现错误" class="header-anchor">#</a> 57、 xadmin后台删除数据出现错误</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>    `get_deleted_objects() takes 3 positional arguments but 5 were given`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这是由于Django2.1版本和xadmin不兼容导致的</p> <p>知道虚拟环境\Lib\site-packages\xadmin\plugins\actions.py</p> <p>修改93行，</p> <p>把</p> <div class="language- extra-class"><pre><code>deletable_objects, model_count, perms_needed, protected = get_deleted_objects(
            queryset, self.opts, self.user, self.admin_site, using)
</code></pre></div><p>改为</p> <div class="language- extra-class"><pre><code>deletable_objects, model_count, perms_needed, protected = get_deleted_objects(
            queryset, self.user, self.admin_site)
</code></pre></div><p>然后在adminx.py文件中对应的模型类中允许删除</p> <div class="language- extra-class"><pre><code>class MaterialAdmin(object):
    &quot;&quot;&quot;素材库分类&quot;&quot;&quot;
    list_display = ['id', 'name', 'class_id', 'is_delete', 'addtime']
  
    def has_delete_permission(self, *args, **kwargs):
        return True
</code></pre></div><h2 id="_58、xdamin限制用户点击"><a href="#_58、xdamin限制用户点击" class="header-anchor">#</a> 58、xdamin限制用户点击</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>//如果登录z=xadmin后台的账号不是【root】的就不能点击更新操作
    var master_name = $('#top-nav').find('strong').text();
        master_name =  master_name.substring(4);
    if(master_name != 'root'){
            $(&quot;.grid-item a&quot;).each(function(index, element) {
                $(this).attr('href','#');
            });
        }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_59、获取公众号关注url"><a href="#_59、获取公众号关注url" class="header-anchor">#</a> 59、获取公众号关注url</h2> <p>在微信网页版，打开公众号，点击右上角“…”，在弹框中选择右下角中间的“查看历史记录”，然后在弹框中选择左上角倒数第一个，“用默认浏览器打开”，就可以在打开的浏览器中获取该公众号的关注url，当把这个url发给好友时，好友点开的就是去关注公众号的页面。</p> <h2 id="_60、xadmin后台用户操作表权限"><a href="#_60、xadmin后台用户操作表权限" class="header-anchor">#</a> 60、xadmin后台用户操作表权限</h2> <p>虚拟环境根目录\Lib\site-packages\xadmin\views\base.py</p> <p>可以找到：</p> <p><img src="https://img-blog.csdnimg.cn/20190627140512311.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>在项目子应用下的adminx.py中使用</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    import xadmin
    
    from machine.models import Machine
    
    
    class MachineAdmin(object):
        list_display = ['code',]  # 显示的字段
    
        search_fields = ['code']  # 搜索的字段
        list_filter = ['code', 'is_delete'] # 过滤的字段
        ordering = ('-id',) # 按id降序排序
        list_editable = ['is_delete', ]  # 数据即时编辑
        list_per_page = 30  # 每页显示数据数量
        model_icon = 'fa fa-cog fa-spin'  # 左侧显示的小图标
    
        def has_delete_permission(self, *args, **kwargs): 
            # 删除权限
            if self.request.user.is_superuser:  # 管理员才能增加
                return True
            return False
    
        def has_add_permission(self, *args, **kwargs):
            if self.request.user.is_superuser:  # 管理员才能增加
                return True
            return False
    
        def has_change_permission(self, *args, **kwargs):
            if self.request.user.is_superuser: # 管理员才能修改
                return True
            return False
    
        def queryset(self):
            qs = super(MachineAdmin, self).queryset()
            if self.request.user.is_superuser:  # 管理员可以查看所有
                return qs
            else:
                # 登录用户只能看到自己修改的数据
                return qs.filter(master_id=self.request.user.last_name)
    
    
    xadmin.site.register(MallMachine, MallMachineAdmin)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h2 id="_61、使用nginx部署项目"><a href="#_61、使用nginx部署项目" class="header-anchor">#</a> 61、使用nginx部署项目</h2> <p>先在/etc/nginx/sites-available中创建一个配置文件，文件名为test(注意没有后缀):</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    #设定虚拟主机配置
        server {
            #侦听80端口
            listen 80;
            listen 443 ssl;
            #定义使用 www.nginx.cn访问
    		#ssl on;
            server_name  xxx.xxx.com;
            #定义服务器的默认网站根目录位置
            root /root/项目名称;
    		ssl_session_timeout 5m; 
            ssl_certificate   /etc/nginx/cert/xxx.pem;
            ssl_certificate_key  /etc/nginx/cert/xxx.key;
            ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;
            ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
            ssl_prefer_server_ciphers on;
            #设定本虚拟主机的访问日志
            #access_log  logs/nginx.access.log  main;
     
            #默认请求
            location / {
                #倒入了uwsgi的配置
                include uwsgi_params; 
    		    client_max_body_size	50m;
                #连接uwsgi的超时时间
               # uwsgi_connect_timeout 30; 
     	    #设定了uwsig服务器位置
     	    	uwsgi_pass 127.0.0.1:8002;
            }
            
            location /static{
          	alias /root/项目名称/static;
            }
    	location /media {
    	alias /root/项目名称/media;
    	}
     
    }

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>其中xxx.xxx.com表示域名.如果没有https，就使用#把ssl注释掉就可以了。</p> <p>然后把test映射到/etc/nginx/sites-enabled</p> <p>命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    ln -s /etc/nginx/sites-available/test /etc/nginx/sites-enabled/test

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>即可
注意：
uwsgi中配置listen=1024时，启动uwsgi时可能会报错：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>django + uwsgi + nginx 日志Listen queue size is greater than the system max net.core.somaxconn (128).
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>解决方法:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>修改系统参数

/proc/sys/net/ipv4/tcp_max_syn_backlog  原来2048    改为8192
/proc/sys/net/core/somaxconn	原来128     改为262144
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>重启nginx</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>nginx -s reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_62、xadmin后台发送邮件找回密码"><a href="#_62、xadmin后台发送邮件找回密码" class="header-anchor">#</a> 62、xadmin后台发送邮件找回密码</h2> <p><img src="https://img-blog.csdnimg.cn/20190710230444358.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>输入你用户绑定的邮箱</p> <p><img src="https://img-blog.csdnimg.cn/20190710230454725.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>想要发送邮件，需要在settings.py中设置邮件发送器</p> <p>settings.py最下面增加</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    # ------------------------邮箱配置-----------------------------------------
    EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend' #把要发送的邮件显示再控制台上，方便调试
    EMAIL_USE_SSL = True
    EMAIL_HOST = 'smtp.qq.com'  # 如果是 163 改成 smtp.163.com
    EMAIL_PORT = 465
    EMAIL_HOST_USER = '邮箱账号' # 帐号
    EMAIL_HOST_PASSWORD = '授权码'  # 到邮箱里开通
    DEFAULT_FROM_EMAIL = EMAIL_HOST_USER

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>由于django2与xadmin有些地方不兼容，需要修改源码：</p> <p>找到虚拟环境根目录\Lib\site-packages\xadmin\plugins\passwords.py</p> <p>在passwords.py文件中大概79行，修改为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    return password_reset_confirm(request=request, uidb36=uidb36, token=token,
                                          template_name=self.password_reset_confirm_template,
                                          token_generator=self.password_reset_token_generator,
                                          set_password_form=self.password_reset_set_form,
                                          post_reset_redirect=self.get_admin_url('xadmin_password_reset_complete'),
                                          current_app=self.admin_site.name, extra_context=context).dispatch(request=request,
                                                                                                            uidb64=uidb36,token=token)
                 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>找到虚拟环境根目录Lib\site-packages\django\contrib\auth\views.py</p> <p>在views.py文件中大概258行，增加：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    # 成功后跳转路由,根据自己实际来定
    self.success_url = self.request.build_absolute_uri('/') + 'xadmin/'

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/2020052620533440.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h2 id="_63、xadmin外键下拉框添加过滤"><a href="#_63、xadmin外键下拉框添加过滤" class="header-anchor">#</a> 63、xadmin外键下拉框添加过滤</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>
class MallGoodsAdmin(object):
    &quot;&quot;&quot;商品管理&quot;&quot;&quot;
    list_display = ['id', 'show_photo', 'nickname', 'merchant', 'goods_class', 'label',]
    search_fields = ['nickname']
    list_filter = ['goods_class', 'label',]
    model_icon = 'fa fa-bars'
    list_editable = ['goods_class', ]
    #,重写虚拟环境根目录下\Lib\site-packages\xadmin\views\edit.py中的formfield_for_dbfield
    def formfield_for_dbfield(self, db_field, **kwargs):
        # 对MallGoodsClass这个表项的下拉框选择进行过滤
        # MallGoods中有一个goods_class商品分类外键MallGoodsClass，过滤掉外键MallGoodsClass中 
        # master_class为空的值
        if db_field.name == &quot;goods_class&quot;:
            kwargs[&quot;queryset&quot;] = MallGoodsClass.objects.filter(master_class__isnull=False)
            # 对assigned_recipient这个表项的下拉选择进行过滤
        	return db_field.formfield(**dict(**kwargs))
        return super().formfield_for_dbfield(db_field, **kwargs)

xadmin.site.register(models.MallGoods, MallGoodsAdmin)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="_64、xadmin即时编辑器去掉空标签"><a href="#_64、xadmin即时编辑器去掉空标签" class="header-anchor">#</a> 64、xadmin即时编辑器去掉空标签</h2> <p><img src="https://img-blog.csdnimg.cn/20190716151440115.png" alt="在这里插入图片描述"></p> <p>虚拟环境根目录下\Lib\site-packages\xadmin\plugins\editable.py，在大概</p> <p>129行增加：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    form.fields[fields[0]].empty_label = None

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20190716151459680.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h2 id="_65、用户增加的小组件-让其他用户可见"><a href="#_65、用户增加的小组件-让其他用户可见" class="header-anchor">#</a> 65、用户增加的小组件，让其他用户可见</h2> <p>找到虚拟环境根目录\Lib\site-packages\xadmin\views\dashboard.py</p> <p>在548行、554行</p> <p><img src="https://img-blog.csdnimg.cn/20190723175537371.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>改为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    @filter_hook
        def get_widgets(self):
    
            if self.widget_customiz:
                portal_pos = UserSettings.objects.filter(
                   key=self.get_portal_key())
                if len(portal_pos):
                    portal_pos = portal_pos[0].value
                    widgets = []
    
                    if portal_pos:
                        user_widgets = dict([(uw.id, uw) for uw in UserWidget.objects.filter(page_id=self.get_page_id())])
                        for col in portal_pos.split('|'):
                            ws = []
                            for wid in col.split(','):
                                try:
                                    widget = user_widgets.get(int(wid))
                                    if widget:
                                        ws.append(self.get_widget(widget))
                                except Exception as e:
                                    import logging
                                    logging.error(e, exc_info=True)
                            widgets.append(ws)
    
                    return widgets
    
            return self.get_init_widget()


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_66、pip-install-uwsgi出错"><a href="#_66、pip-install-uwsgi出错" class="header-anchor">#</a> 66、pip install uwsgi出错</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>plugins/python/uwsgi_python.h:2:20: fatal error: Python.h: No such file or directory

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>首先安装python3环境</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apt install python3-dev

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后再虚拟环境中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip install uwsgi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_66、xadmin后台加载数据慢-解决方案"><a href="#_66、xadmin后台加载数据慢-解决方案" class="header-anchor">#</a> 66、xadmin后台加载数据慢，解决方案</h2> <p>list_filter: 过滤器要慎用，不要使用类似id这些数据量大的字段</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    class MallUserAdmin(object):
        &quot;&quot;&quot;用户管理&quot;&quot;&quot;
    
        list_display = ['id', 'tp_icon', 'nickname', 'phone', 'level', 'balance', 'province', 'city', 'quxian']  # 显示字段
        search_fields = ['id', 'nickname', 'phone']  # 搜索
        list_filter = ['level', 'province', 'city', 'quxian']  # 过滤器
        # list_filter = ['id', 'level', 'province', 'city', 'quxian']  # 如果加id，xadmin加载回来的数据就会很慢，所以不要在过滤器上使用id
        list_per_page = 30  # 默认每页数量
        model_icon = 'fa fa-users'  # 左侧图标
        ordering = ['-id']  # 排序
        readonly_fields = ['subscribe', 'wx_openid', 'phone']  # 只读字段
        is_addbalance = True   # 加载自定义的插件
        relfield_style = 'fk-ajax'  # 其他表如果外键到用户表就做ajax搜索查询，不一次性加载数据

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_67-、xadmin导出插件处理-增加导出勾选数据项"><a href="#_67-、xadmin导出插件处理-增加导出勾选数据项" class="header-anchor">#</a> 67 、xadmin导出插件处理，增加导出勾选数据项</h2> <p>常规的导出只有两个选择【导出表头】、【导出全部数据】</p> <p><img src="https://img-blog.csdnimg.cn/20190917141511283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>现在想要做的是增加一个选择，即【导出表头】、【导出全部数据】、【导出勾选数据】，如下图：</p> <p><img src="https://img-blog.csdnimg.cn/20190917141839822.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>需要修改xadmin源代码，具体如下</p> <h4 id="_1、加载js文件"><a href="#_1、加载js文件" class="header-anchor">#</a> 1、加载js文件</h4> <p>找到虚拟环境\Lib\site-packages\xadmin\views\list.py，在607行增加’xadmin.plugin.importexport.js’，如下图所示</p> <p><img src="https://img-blog.csdnimg.cn/20190917141853832.png" alt="在这里插入图片描述"></p> <h4 id="_2、修改export-py-后端处理下载文件"><a href="#_2、修改export-py-后端处理下载文件" class="header-anchor">#</a> 2、修改export.py，后端处理下载文件</h4> <p>找到虚拟环境\Lib\site-packages\xadmin\plugins\export.py</p> <p>在84行把rows = context[‘results’]修改成如下函数</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    # 新增导出所选数据
    # rows = context['results']  
    rows = []
    select_across = self.request.GET.get('_select_across', False) == '1'
    selected = self.request.GET.get('_selected_actions', '')
    if self.request.GET.get('selected', 'off') == 'on':
        if not select_across:
            selected_pk = selected.split(',')
            for i in context['results']:
                if str(i['object'].id) in selected_pk:
                    rows.append(i)
        else:
            rows = context['results']
    else:
        rows = context['results']

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/2019091714200418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>3、 修改model_list.top_toolbar.exports.html
找到虚拟环境\Lib\site-packages\xadmin\templates\xadmin\blocks\model_list.top_toolbar.exports.html</p> <p>使用以下代码覆盖原文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    {% load i18n %}
    &lt;div class=&quot;btn-group export&quot;&gt;
        &lt;a id=&quot;export-menu&quot; class=&quot;dropdown-toggle btn btn-default btn-sm&quot; data-toggle=&quot;dropdown&quot; href=&quot;#&quot;&gt;
            &lt;i class=&quot;fa fa-share&quot;&gt;&lt;/i&gt; {% trans &quot;Export&quot; %} &lt;span class=&quot;caret&quot;&gt;&lt;/span&gt;
        &lt;/a&gt;
        &lt;ul class=&quot;dropdown-menu&quot; role=&quot;menu&quot; aria-labelledby=&quot;dLabel&quot;&gt;
            {% for et in export_types %}
            &lt;li&gt;&lt;a data-toggle=&quot;modal&quot; data-target=&quot;#export-modal-{{et.type}}&quot;&gt;&lt;i class=&quot;fa fa-arrow-circle-down&quot;&gt;
            &lt;/i&gt; {% trans &quot;Export&quot; %} {{et.name}}&lt;/a&gt;&lt;/li&gt;
            {% endfor %}
        &lt;/ul&gt;
    
        {% for et in export_types %}
        &lt;div id=&quot;export-modal-{{et.type}}&quot; class=&quot;modal fade&quot;&gt;
            &lt;div class=&quot;modal-dialog&quot;&gt;
                &lt;div class=&quot;modal-content&quot;&gt;
                    &lt;form method=&quot;get&quot; action=&quot;&quot;&gt;
    
                        &lt;div class=&quot;modal-header&quot;&gt;
                            &lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/button&gt;
                            &lt;h4 class=&quot;modal-title&quot;&gt;{% trans &quot;Export&quot; %} {{et.name}}&lt;/h4&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;modal-body&quot;&gt;
                            {{ form_params|safe }}
                            &lt;input type=&quot;hidden&quot; name=&quot;export_type&quot; value=&quot;{{et.type}}&quot;&gt;
                            &lt;!-- 增加 导出所选数据 一栏 --&gt;
                            &lt;input type=&quot;hidden&quot; name=&quot;_selected_actions&quot; value=&quot;&quot;/&gt;
                            &lt;input type=&quot;hidden&quot; name=&quot;_select_across&quot; value=&quot;&quot;/&gt;
    
                            &lt;label class=&quot;checkbox&quot;&gt;
                                {% if et.type == &quot;xlsx&quot; %}
                                &lt;input type=&quot;checkbox&quot; name=&quot;export_xlsx_header&quot; checked=&quot;checked&quot; value=&quot;on&quot;&gt;
                                {% trans &quot;Export with table header.&quot; %}
                                {% endif %}
                                {% if et.type == &quot;xls&quot; %}
                                &lt;input type=&quot;checkbox&quot; name=&quot;export_xls_header&quot; checked=&quot;checked&quot; value=&quot;on&quot;&gt;
                                {% trans &quot;Export with table header.&quot; %}
                                {% endif %}
                                {% if et.type == &quot;csv&quot; %}
                                &lt;input type=&quot;checkbox&quot; name=&quot;export_csv_header&quot; checked=&quot;checked&quot; value=&quot;on&quot;&gt;
                                {% trans &quot;Export with table header.&quot; %}
                                {% endif %}
                                {% if et.type == &quot;xml&quot; %}
                                &lt;input type=&quot;checkbox&quot; name=&quot;export_xml_format&quot; checked=&quot;checked&quot; value=&quot;on&quot;&gt;
                                {% trans &quot;Export with format.&quot; %}
                                {% endif %}
                                {% if et.type == &quot;json&quot; %}
                                &lt;input type=&quot;checkbox&quot; name=&quot;export_json_format&quot; checked=&quot;checked&quot; value=&quot;on&quot;&gt;
                                {% trans &quot;Export with format.&quot; %}
                                {% endif %}
                            &lt;/label&gt;
                            &lt;label class=&quot;checkbox&quot;&gt;
                                &lt;input type=&quot;checkbox&quot; name=&quot;all&quot; value=&quot;on&quot;&gt; {% trans &quot;Export all data.&quot; %}
                            &lt;/label&gt;
                            &lt;!-- 增加 导出所选数据 一栏 --&gt;
                            &lt;label class=&quot;checkbox&quot;&gt;
                                &lt;input type=&quot;checkbox&quot; name=&quot;selected&quot; value=&quot;on&quot;&gt; 导出勾选数据
                            &lt;/label&gt;
    
                        &lt;/div&gt;
                        &lt;div class=&quot;modal-footer&quot;&gt;
                            &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot; data-dismiss=&quot;modal&quot;&gt;{% trans &quot;Close&quot; %}&lt;/button&gt;
    
                            &lt;button class=&quot;btn btn-success myexport  glyphicon glyphicon-export &quot; type=&quot;submit&quot;&gt;&lt;i
                                    class=&quot;fa fa-share&quot;&gt;&lt;/i&gt; {% trans &quot;Export&quot; %}
                            &lt;/button&gt;
                        &lt;/div&gt;
                    &lt;/form&gt;
                &lt;/div&gt;&lt;!-- /.modal-content --&gt;
            &lt;/div&gt;&lt;!-- /.modal-dalog --&gt;
        &lt;/div&gt;&lt;!-- /.modal --&gt;
        {% endfor %}
    
    &lt;/div&gt;
    
    &lt;script type=&quot;text/javascript&quot;&gt;
        // 如果是订单导出，把待出货订单设置成待收货订单
        $(document).ready(function () {
            $('.myexport').click(function () {
                // 当把订单导出时，需要修改订单状态为待收货状态
                var url = window.location.protocol + '//' + window.location.host + &quot;/exportorder/&quot;;
                $(&quot;input[name='_select_across']&quot;).val($(&quot;input[name='select_across']&quot;).val());
                if ($(&quot;input[name='selected']&quot;).is(':checked')) {
                    var arr = [];
                    $.each($('.action-select'), function () {
                        if (true == $(this).prop('checked')) {
                            arr.push($(this).val());
                        }
                    });
                    if(arr.length == 0){
                        alert('请先勾选导出数据')
                        return false
                    }
                }else{
                    var arr = []
                    var order_type = $('.breadcrumb li').eq(1).text().trim()
                    $('.grid-item').each(function (index, el) {
    
                        arr.push($(el).find('td').eq(1).text().trim())
                    })
                }
                if (($('.breadcrumb &gt; li').eq(1).text()).indexOf('订单') != -1) {
                    // 5秒后执行
                    setTimeout(function () {
                        $.ajax({
                            type: &quot;POST&quot;,
                            url: url,
                            data: {'orderlist': JSON.stringify(arr), 'order_type': order_type,},
                            beforeSend: function (xhr) {
                                xhr.setRequestHeader(&quot;X-CSRFToken&quot;, $.getCookie(&quot;csrftoken&quot;))
                            },
                            success: function (data) {
                                window.location.reload();
                            },
                            error: function (xhr) {
                                alert(&quot;出现未知错误&quot;);
                                window.location.reload();
                            }
                        });
                    }, 5000);
                }
            });
        })
    &lt;/script&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br></div></div><h2 id="_68、使用f查询更新用户重要数据"><a href="#_68、使用f查询更新用户重要数据" class="header-anchor">#</a> 68、使用F查询更新用户重要数据</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>    from django.db.models import F
    # 使用F查询更新用户余额
    balance = 5  
    MallUser.objects.filter(id=1).update(balance=F('balance') + balance)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>相当于sql的</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    update Malluser set balance=balance + 5 where id=1;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_69、日志输出模块"><a href="#_69、日志输出模块" class="header-anchor">#</a> 69、日志输出模块</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>    import logging
    import platform
    # 全局函数
    PlATFORM = platform.system()
    if (PlATFORM == &quot;Linux&quot;):
        # linux系统,文件保存在var下
        SERVER_LOG_PATH = '/var/mylog.log'
    else:
        # windows系统,文件保存在D盘下
        SERVER_LOG_PATH = 'D:\mylog.log'
    # 定义一个logging的对象，命名为mylog
    LOGGER = logging.getLogger('mylog')
    # 设置级别为WARNING
    LOGGER.setLevel(logging.WARNING)
    # 创建一个handler，用于写入日志文件
    fh = logging.FileHandler(SERVER_LOG_PATH, encoding='utf-8')
    fh.setLevel(logging.WARNING)
    # 定义handler的输出格式
    formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s', datefmt='%Y-%m-%d %H:%M:%S')
    fh.setFormatter(formatter)
    # 给Logger添加handler
    LOGGER.addHandler(fh)
    # 不在控制台显示
    LOGGER.propagate = False

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="_70、字典排序"><a href="#_70、字典排序" class="header-anchor">#</a> 70、字典排序</h2> <p>字典在内存中发布是无序的，当想对键值或者键名进行排序时可以先把字典转成元组，这可以达到排序的目的。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>score = {'小明': {'avg_score': 90, 'English': 90, 'Math': 90, 'Chniese': 90, },
     '小红': {'avg_score': 60, 'English': 60, 'Math': 61, 'Chniese': 59, },
     '小黑': {'avg_score': 70, 'English': 75, 'Math': 65, 'Chniese': 70, },
     '小白': {'avg_score': 80, 'English': 95, 'Math': 65, 'Chniese': 80, },
     }
# 对姓名进行排序，即对键名进行排序
b = sorted(score.items(), key=lambda x: x[0], reverse=True)
show_str = ''
for info in b:
    # print(info)
    key, value = info[0], info[1]
    show_str += '姓名：{},平均分：{}，成绩：{}'.format(key,value['avg_score'], value) + '\r\n'
print('对姓名进行排序')
print(show_str)
# 对平均分进行排序
b = sorted(score.items(), key=lambda x: x[1]['avg_score'], reverse=True)
show_str = ''
for info in b:
    # print(info)
    key, value = info[0], info[1]
    show_str += '姓名：{},平均分：{}，成绩：{}'.format(key,value['avg_score'], value) + '\r\n'
print('对平均分进行排序')
print(show_str)

# 对英语成绩进行排序
b = sorted(score.items(), key=lambda x: x[1]['English'], reverse=True)
show_str = ''
for info in b:
    # print(info)
    key, value = info[0], info[1]
    show_str += '姓名：{},平均分：{}，成绩：{}'.format(key,value['avg_score'], value) + '\r\n'
print('对英语成绩进行排序')
print(show_str)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>对姓名进行排序
姓名：小黑,平均分：70，成绩：{'avg_score': 70, 'English': 75, 'Math': 65, 'Chniese': 70}
姓名：小红,平均分：60，成绩：{'avg_score': 60, 'English': 60, 'Math': 61, 'Chniese': 59}
姓名：小白,平均分：80，成绩：{'avg_score': 80, 'English': 95, 'Math': 65, 'Chniese': 80}
姓名：小明,平均分：90，成绩：{'avg_score': 90, 'English': 90, 'Math': 90, 'Chniese': 90}

对平均分进行排序
姓名：小明,平均分：90，成绩：{'avg_score': 90, 'English': 90, 'Math': 90, 'Chniese': 90}
姓名：小白,平均分：80，成绩：{'avg_score': 80, 'English': 95, 'Math': 65, 'Chniese': 80}
姓名：小黑,平均分：70，成绩：{'avg_score': 70, 'English': 75, 'Math': 65, 'Chniese': 70}
姓名：小红,平均分：60，成绩：{'avg_score': 60, 'English': 60, 'Math': 61, 'Chniese': 59}

对英语成绩进行排序
姓名：小白,平均分：80，成绩：{'avg_score': 80, 'English': 95, 'Math': 65, 'Chniese': 80}
姓名：小明,平均分：90，成绩：{'avg_score': 90, 'English': 90, 'Math': 90, 'Chniese': 90}
姓名：小黑,平均分：70，成绩：{'avg_score': 70, 'English': 75, 'Math': 65, 'Chniese': 70}
姓名：小红,平均分：60，成绩：{'avg_score': 60, 'English': 60, 'Math': 61, 'Chniese': 59}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="对列表中字典按多个键值排序"><a href="#对列表中字典按多个键值排序" class="header-anchor">#</a> 对列表中字典按多个键值排序</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>from operator import itemgetter
data = [
    {'code': 1, 'position': 300, 'time': '1620442242'},
    {'code': 2, 'position': 255, 'time': '1620442242'},
    {'code': 3, 'position': 256, 'time': '1620442242'},
    {'code': 1, 'position': 500, 'time': '1620442242'},
    {'code': 5, 'position': 455, 'time': '1620442242'},
    {'code': 1, 'position': 322, 'time': '1620442242'},
    {'code': 6, 'position': 676, 'time': '1620442242'},
]
data = sorted(data, key=itemgetter('code', 'position'))

print(data)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[
{'code': 1, 'position': 300, 'time': '1620442242'}, 
{'code': 1, 'position': 322, 'time': '1620442242'}, 
{'code': 1, 'position': 500, 'time': '1620442242'}, 
{'code': 2, 'position': 255, 'time': '1620442242'}, 
{'code': 3, 'position': 256, 'time': '1620442242'}, 
{'code': 5, 'position': 455, 'time': '1620442242'}, 
{'code': 6, 'position': 676, 'time': '1620442242'}]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_71、时间格式与字符串互转、比较大小"><a href="#_71、时间格式与字符串互转、比较大小" class="header-anchor">#</a> 71、时间格式与字符串互转、比较大小</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import datetime

# 当前时间转字符串
now = datetime.datetime.strftime(datetime.datetime.now(), '%Y-%m-%d %H:%M:%S')
# 字符串转时间格式
now = datetime.datetime.strptime(now, '%Y-%m-%d %H:%M:%S')
a = now + datetime.timedelta(minutes=-15)
# 时间比较大小
if a &lt; now:
    print('yes')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_72、python把-u-开头的字符串转中文"><a href="#_72、python把-u-开头的字符串转中文" class="header-anchor">#</a> 72、python把’\u’开头的字符串转中文</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>str_data = '\\u7528\\u6237 ID \\u6216\\u5bc6\\u7801\\u9519\\u8bef'
# 字符串.encode('utf-8').decode('unicode_escape')
str_data_to_zh = str_data.encode('utf-8').decode('unicode_escape')
print(str_data_to_zh)

# 输出
用户 ID 或密码错误
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_73、django进行数据迁移时出现no-changes-detected解决方案"><a href="#_73、django进行数据迁移时出现no-changes-detected解决方案" class="header-anchor">#</a> 73、django进行数据迁移时出现No changes detected解决方案</h2> <p>原因：可能是由于app下面没有migrations文件夹
所以需要创建这个文件夹，命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>python manage.py makemigrations --empty 你的app名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_74、ubuntu下载文件到windows桌面"><a href="#_74、ubuntu下载文件到windows桌面" class="header-anchor">#</a> 74、ubuntu下载文件到windows桌面</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>apt install lrzsz
sz 123.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_75、git查看提交日志"><a href="#_75、git查看提交日志" class="header-anchor">#</a> 75、git查看提交日志</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code> git log --author=&quot;ldc&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_76、python翻译模块"><a href="#_76、python翻译模块" class="header-anchor">#</a> 76、python翻译模块</h2> <p>可以把英文翻译成中文，也可以把中文翻译成英文</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip install  translate

from translate import Translator

name = 'giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca'
translator = Translator(to_lang=&quot;chinese&quot;)
translation = translator.translate(name)
print(translation)

translator= Translator(from_lang=&quot;chinese&quot;,to_lang=&quot;english&quot;)
translation = translator.translate(&quot;我想你&quot;)
print(translation)


输出：

大熊猫，熊猫，熊猫熊，浣熊，大熊猫
I missed you.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_77、python实现字符串转字典"><a href="#_77、python实现字符串转字典" class="header-anchor">#</a> 77、python实现字符串转字典</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import ast
import json

target_str = '{&quot;h&quot;: 1, &quot;e&quot;: 2, &quot;l&quot;: 3, &quot;l&quot;: 4, &quot;o&quot;: 5}'
target_str2 = &quot;{'h': 1, 'e': 2, 'l': 3, 'l': 4, 'o': 5}&quot;

# 方式1：使用json，缺点，字符串中不能出现单引号
# 由于 json 语法规定 数组或对象之中的字符串必须使用双引号，不能使用单引号
# 官网https://www.json.org/json-en.html上有一段描述是
# A string is a sequence of zero or more Unicode characters, wrapped in double quotes, using backslash escapes
print(json.loads(target_str))
# print(json.loads(target_str2))   # 使用json转这个字符串会报错 Expecting property name enclosed in double quotes

# 方式2：使用eval函数，缺点，不安全
print(eval(target_str))
print(eval(target_str2))
# print(eval(&quot;__import__('os').system('dir')&quot;))  # 会列出当前的目录文件，如果字符串是一些删除命令，则可以把整个目录清空！

# 方式3，使用ast.literal_eval，没有json与eval的缺点，推荐使用这个
print(ast.literal_eval(target_str))
print(ast.literal_eval(target_str2))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{'h': 1, 'e': 2, 'l': 4, 'o': 5}
{'h': 1, 'e': 2, 'l': 4, 'o': 5}
{'h': 1, 'e': 2, 'l': 4, 'o': 5}
{'h': 1, 'e': 2, 'l': 4, 'o': 5}
{'h': 1, 'e': 2, 'l': 4, 'o': 5}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_78、django-app-如何在后台显示中文名"><a href="#_78、django-app-如何在后台显示中文名" class="header-anchor">#</a> 78、django app 如何在后台显示中文名</h2> <p>1.在app (这里以user为例)下面的__init__.py文件中</p> <p>添加:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>default_app_config = 'user.apps.UserConfig'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.在apps.py中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>from django.apps import AppConfig

class UserConfig(AppConfig):
    name = 'user'
    verbose_name = '用户'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_79、使用python给excel指定行添加数据"><a href="#_79、使用python给excel指定行添加数据" class="header-anchor">#</a> 79、使用python给Excel指定行添加数据</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import openpyxl, sys

wb = openpyxl.load_workbook('b.xlsx')
sheet = wb['Sheet1']

# 在excel表格第二行添加新数据
addrow = 1   # 增加一行
row = 2  # 在第二行新增一行
name = 'b-back.xlsx' # 新的表名

wb1 = openpyxl.Workbook()
sheet1 = wb1['Sheet']

# 复制前row行
for i in range(1, row):
    for j in range(1, sheet.max_column + 1):
        sheet1.cell(row=i, column=j).value = sheet.cell(row=i, column=j).value


# 复制后row行
for i in range(row, sheet.max_row + 1):
    for j in range(1, sheet.max_column + 1):
        if i == row:
            # 给第row行添加新的数据
            sheet1.cell(row=row, column=j).value = '新增'
        sheet1.cell(row=i + addrow, column=j).value = sheet.cell(row=i, column=j).value

wb1.save(name)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200526120005871.png" alt="在这里插入图片描述"></p> <h2 id="_80、python中的format格式拼接字符串"><a href="#_80、python中的format格式拼接字符串" class="header-anchor">#</a> 80、python中的format格式拼接字符串</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>d = {'a': 1, 'b': 2, 'c': 3, 'd': 5}

print('{a},{b}'.format(**d))
print('{0},{1},{0}'.format('a', 'b'))
print(f&quot;{d['a']}&quot;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1,2
a,b,a
1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_81、数据库inner-join、full-join、left-join、union、union-all区别"><a href="#_81、数据库inner-join、full-join、left-join、union、union-all区别" class="header-anchor">#</a> 81、数据库inner join、full join、left join、union、union all区别</h2> <p>表a_test</p> <p><img src="https://img-blog.csdnimg.cn/20200529102527295.png#pic_center" alt="在这里插入图片描述"></p> <p>表b_test</p> <p><img src="https://img-blog.csdnimg.cn/20200529102549669.png#pic_center" alt="在这里插入图片描述"></p> <p>INNER JOIN</p> <p>是A和B的交集</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT * FROM a_test INNER JOIN b_test ON a_test.name = b_test.namesa

Inner join 产生的结果集中，是A和B的交集。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102631494.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <p>FULL OUTER JOIN</p> <p>产生A和B的并集</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT * FROM a_test FULL OUTER JOIN b_test ON a_test.name = b_test.name 

Full outer join 产生A和B的并集。
但是需要注意的是，对于没有匹配的记录，则会以null做为值。
可以使用IF NULL判断。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102702865.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT * FROM a_test FULL OUTER JOIN b_test ON a_test.name = b_test.name
WHERE a_test.id IS null OR b_test.id IS null

产生A表和B表没有交集的数据集。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102724731.png#pic_center" alt="在这里插入图片描述"></p> <p>LEFT [OUTER] JOIN</p> <p>产生表A的完全集，而B表中匹配的则有值，没有匹配的则以null值取代</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT * FROM a_test LEFT OUTER JOIN b_test ON a_test.name = b_test.name
有些数据库可以不要OUTER
SELECT * FROM a_test LEFT  JOIN b_test ON a_test.name = b_test.name
Left outer join 产生表A的完全集，而B表中匹配的则有值，没有匹配的则以null值取代。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102808618.png#pic_center" alt="在这里插入图片描述"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT * FROM a_test LEFT OUTER JOIN b_test ON a_test.name = b_test.name 
WHERE b_test.id IS null

产生在A表中有而在B表中没有的集合。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102828846.png#pic_center" alt="在这里插入图片描述"></p> <p>RIGHT [OUTER] JOIN</p> <p>RIGHT OUTER JOIN 是后面的表为基础，与LEFT OUTER JOIN用法类似。</p> <p>UNION 与 UNION ALL</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>UNION 操作符用于合并两个或多个 SELECT 语句的结果集。
请注意，UNION 内部的 SELECT 语句必须拥有相同数量的列。
列也必须拥有相似的数据类型。
同时，每条 SELECT 语句中的列的顺序必须相同。
UNION 只选取记录，而UNION ALL会列出所有记录。

SELECT name FROM a_test UNION SELECT name FROM b_test

选取不同值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102855430.png#pic_center" alt="在这里插入图片描述"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT a_test.id,a_test.name  FROM a_test 
UNION 
SELECT b_test.id,b_test.name FROM b_test

由于 id 51 xh   与 id 4 xh 并不相同，不合并


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102917488.png#pic_center" alt="在这里插入图片描述"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT name FROM a_test UNION ALL SELECT name FROM b_test

全部列出来

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200529102937801.png#pic_center" alt="在这里插入图片描述"></p> <p>还需要注意的是我们还有一个是“交差集” cross join, 这种Join没有办法用文式图表示，因为其就是把表A和表B的数据进行一个N*M的组合，即笛卡尔积。</p> <p>表达式如下：SELECT * FROM a_test CROSS JOIN b_test</p> <p>这个笛卡尔乘积会产生 4 x 4 = 16 条记录，一般来说，我们很少用到这个语法。但是我们得小心，如果不是使用嵌套的select语句，一般系统都会产生笛卡尔乘积然再做过滤。这是对于性能来说是非常危险的，尤其是表很大的时候。</p> <h2 id="_82、windows电脑查看端口使用情况"><a href="#_82、windows电脑查看端口使用情况" class="header-anchor">#</a> 82、windows电脑查看端口使用情况</h2> <p>找出8000端口对应的PID进程，命令为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>netstat -ano|findstr 8000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>进程信息如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> TCP    0.0.0.0:8000           0.0.0.0:0              LISTENING       1620
 UDP    0.0.0.0:8000           *:*                                    1620
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>找出进程对应的详细信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tasklist |findstr 1620

KGService.exe                 1620 Console                    1     18,696 K
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>关进程：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>taskkill /pid 1620 /F
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看程序占用内存
比如查看python占用运行内存</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tasklist  /fi &quot;imagename eq python.exe&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/a61afd069e964e6f9d755c5c1884ca6f.png" alt="在这里插入图片描述"></p> <h2 id="_83、django生成表和反向生成model"><a href="#_83、django生成表和反向生成model" class="header-anchor">#</a> 83、Django生成表和反向生成Model</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>正向生成：
python manage.py makemigrations
python manage.py migrate

反向：
会根据设置的数据库中的表在自动生成对应的Model代码，并打印出来
python manage.py inspectdb

以直接将打印的代码直接导入到指定的Model文件中
python manage.py inspectdb &gt; models.py
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_84、windows的hosts文件位置"><a href="#_84、windows的hosts文件位置" class="header-anchor">#</a> 84、windows的hosts文件位置</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>C:\Windows\System32\drivers\etc\hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_85、postgresql数据库"><a href="#_85、postgresql数据库" class="header-anchor">#</a> 85、postgresql数据库</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># 如果表存在就先删除
drop table if exists student;
# 创建学生表
# id      serial not null  表示id自增
# id      integer not null  表示id不自增
create table student
(
    id                    serial not null
        constraint student_pk
            primary key,
    name                  varchar,
    class_id              integer,
    height                numeric,
    weight                numeric,
    write_date            timestamp
    
);

comment on table student is '学生表';

comment on column student.name is '名称';

comment on column student.class_id is '班级ID';

comment on column student.height is '身高';

comment on column student.weight is '体重';

comment on column student.write_date is '修改时间';

alter table student
    owner to odoo;


# 更新
update user set name='张三' where id=111

# 更新表a的字段为表b的值
update account_invoice 
set sale_order_id=so.id 
from sale_order so 
where account_invoice.origin=so.name

# 新增
insert into &quot;user&quot; (name,sex) values ('小明',1),('小红', 0)
# 新增或更新
如果id冲突就更新
INSERT INTO  student(id, name)
   VALUES(12, '小明'),(13, '小红')
   ON conflict(id) DO UPDATE
   SET name ='未知';
如果id冲突就什么也不做
INSERT INTO  student(id, name)
   VALUES(12, '小明'),(13, '小红')
   ON conflict(id) DO NOTHING;

# 把一个表中的数据插入到另一个表中
insert into 目标表名 (column1,column2,columnn) select value1,value2,valuen from  源表名
比如：
insert into student (name, classs_name,create_date) select  student_name as name, class_name, now() from class_table;

# 获取当前时间
now()
select now()

# 删除
DELETE FROM table_name [WHERE Clause]

# 增加字段
alter table 表名 add column 列名 类型;
# 删除字段
alter table 表名 dropcolumn 列名 ;

# postgresql数据库查看表所有字段
select * from information_schema.columns where table_schema='public' and table_name='表名';

# postgresql获取所有表名
select tablename from pg_tables where schemaname='public'

# 对查询结果按id降序显示
select * from table_name order by id desc

# 对查询结果按id升序显示
select * from table_name order by id asc

# 转义字符, 查找name中包含单引号的记录
select * from student where name like  E'%\'%';

# 查看表记录总数
select relname as TABLE_NAME, reltuples as rowCounts from pg_class where relkind = 'r' and relnamespace = (select oid from pg_namespace where nspname='public') order by rowCounts desc;

# 将结果转换为数组
SELECT array(SELECT &quot;name&quot; FROM sale_order);

# 将数组合并为字符串
select array_to_string(array[1,2,3], ',')

# 联合子集更新，把sale_order_line的name连接换行符，然后按id更新到表a_test中对应的name
update a_test set name=array_to_string(array(select name from sale_order_line where order_id=a_test.id),'&lt;br/&gt;');

# PostgreSQL合并查询同一列的多条记录，针对一对多，多对多字段
比如表：

id   name                  
1    小明                   
1    小红                     id   name
1    小亮        --&gt;          1    小明，小亮，小红
2    小强                     2    小强，小王
2    小王

SELECT 
    id, array_to_string(ARRAY(SELECT unnest(array_agg(name order by name desc))),',') AS all_name
FROM  
    student
GROUP BY id;

# case语句
case var
	when condition1 then statement1
	when condition2 then statement2
else statementn
end as new_name

比如：
select case name
	when '小明' then 'xm'
	when '小红' then 'xh'
	when '小刚' then 'xg'
else 'xw'
end as short_name
from student

# 临时表、字符串合并、类型转换、时间格式转换、当前时间
WITH TEMP AS ( 
	SELECT CAST ( concat ( bam.account_period_code, '-01' ) AS TIMESTAMP ) 
	   AS account_period_time 
		 FROM bi_account_move AS bam ) 
SELECT
	account_period_time,
	to_char(CURRENT_DATE,'yyyy-MM-dd hh24:MI:ss') as current_date,
	to_char( account_period_time, 'yyyy' ) as year,
	to_char( account_period_time, 'MM' ) as month,
	to_char( account_period_time, 'dd' ) as day 
FROM TEMP

比如：
account_period_time	current_date	    year	month	day
2019-06-01 0:00:00	2020-06-24 00:00:00	2019	 06	     01
2019-06-01 0:00:00	2020-06-24 00:00:00	2019	 06	     01

# 多个字符串拼接
select 
concat('payment_', CAST(ap.id as varchar)) as line_key
from ap

# 将查询所得结果集的某一字段拼接成字符串，默认的是逗号
select GROUP_CONCAT(id) from test where id&gt;5;
结果为：
1,2,3,4,5,6,7
# 使用其他分隔符拼接
select GROUP_CONCAT(id separator '-') from test where id&gt;5;
结果为：
1-2-3-4-5-6-7
# 多个临时表
WITH temp_student AS ( SELECT ID, NAME, sex FROM student WHERE sex = TRUE ),
temp_class AS (
	SELECT
		ID,
		NAME,
		student_id,
		teacher_id
	FROM
		the_class 
	),
	temp_teacher AS (
	SELECT 
	  ID,
		NAME,
		age 
	FROM
		teacher 
	) 
	SELECT
	ts.NAME AS student_name,
	tc.NAME AS class_name,
	te.NAME AS teacher_name
	from temp_student as ts
	LEFT JOIN temp_class AS tc ON tc.student_id = ts.ID  
	LEFT JOIN teacher AS te ON te.id = tc.teacher_id  

# null转成有意义的值
select COALESCE(name, '') as name from a_test
意思就是如果name为null，就转为空字符串

# 字符串截取
select SUBSTRING('abcd',1,2); -- result:ab 表示从下标从1开始,截取2个字符

# 使用 interval 时间相加减(+/-)
当前时间 + 10秒，
select to_char(now() + interval '10 second', 'yyyy-mm-dd hh24:mi:ss')  as reqDate from account_period;
当前时间 - 10秒
select to_char(now() + interval '-10 second', 'yyyy-mm-dd hh24:mi:ss')  as reqDate from account_period;
 
当前时间 + 10分，
select to_char(now() + interval '10 minute', 'yyyy-mm-dd hh24:mi:ss')  as reqDate  from account_period;
 
当前时间 + 10时，
select to_char(now() + interval '10 hour', 'yyyy-mm-dd hh24:mi:ss')  as reqDate from account_period;
 
当前时间 + 10天，
select to_char(now() + interval '10 day', 'yyyy-mm-dd hh24:mi:ss')  as reqDate from account_period;

当前时间 + 10年，
select to_char(now() + interval '10 year', 'yyyy-mm-dd hh24:mi:ss')  as reqDate from account_period;

# UNION types numeric and text cannot be matched
NULL::NUMERIC
 这个问题，是因为几个sql组合在一起时，同一个字段的值，遇到null时，需要进行类型转换。

# 对行记录定义行编号，使用函数ROW_NUMBER()
# 按分数进行降序，然后给行记录标记行编号，可以作为排名来使用
select           
	ROW_NUMBER() OVER (ORDER BY score desc) AS sequence_number,
	name,score
from
	b_test

# 数字转字符串  
select cast(123 as VARCHAR); 

# 字符串转数字  
select cast('123' as INTEGER);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br></div></div><h2 id="_86、python控制台输出带颜色的文字方法"><a href="#_86、python控制台输出带颜色的文字方法" class="header-anchor">#</a> 86、python控制台输出带颜色的文字方法</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>#格式：　　设置颜色开始 ：\033[显示方式;前景色;背景色m
#说明：
前景色            背景色           颜色
---------------------------------------
30                40              黑色
31                41              红色
32                42              绿色
33                43              黃色
34                44              蓝色
35                45              紫红色
36                46              青蓝色
37                47              白色
显示方式           意义
-------------------------
0                终端默认设置
1                高亮显示
4                使用下划线
5                闪烁
7                反白显示
8                不可见
 
#例子：
\033[1;31;40m    &lt;!--1-高亮显示 31-前景色红色  40-背景色黑色--&gt;
\033[0m          &lt;!--采用终端默认设置，即取消颜色设置--&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>例子
print('紫红字体 \033[1;35m hello world \033[0m!')
print('褐色背景绿色字体 \033[1;32;43m hello world \033[0m!')
print('\033[1;33;44mhello world\033[0m')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200615143709116.png" alt="在这里插入图片描述"></p> <h2 id="_87、控制台输出白色方框"><a href="#_87、控制台输出白色方框" class="header-anchor">#</a> 87、控制台输出白色方框</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>print('█')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_88、xadmin后台编辑多对多字段"><a href="#_88、xadmin后台编辑多对多字段" class="header-anchor">#</a> 88、xadmin后台编辑多对多字段</h2> <p>在models.py定义了多对多字段，想要在编辑时可以灵活使用这个字段的话，可以按以下方法设置：
modes.py</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>class Book(models.Model):
    title = models.CharField(verbose_name=&quot;书名&quot;, max_length=32)
    second_title = models.CharField(verbose_name=&quot;副标题&quot;, max_length=32, blank=True, null=True)
    author = models.CharField(verbose_name=&quot;作者&quot;, max_length=32)
    translator = models.CharField(verbose_name=&quot;译者&quot;, max_length=32, blank=True, null=True)
    intro = models.TextField(verbose_name=&quot;描述&quot;)
    pic = models.FileField(verbose_name=&quot;封面图片&quot;, max_length=64, upload_to='book_cover', null=True, blank=True)
    tags = models.ManyToManyField(Tags, verbose_name='书籍标签', blank=True)
    prizes = models.ManyToManyField(Prizes, verbose_name='获奖详情', blank=True)
    sump = models.IntegerField(verbose_name=&quot;收藏人数&quot;, default=0)
    rate_num = models.IntegerField(verbose_name=&quot;评分人数&quot;, default=0)
    num = models.IntegerField(verbose_name=&quot;浏览量&quot;, default=0)
    published_time = models.DateField(blank=True, null=True, verbose_name='出版时间')
    create_time = models.DateTimeField(auto_now_add=True, verbose_name='创建时间')

    class Meta:
        db_table = 'book'
        verbose_name = &quot;图书&quot;
        verbose_name_plural = &quot;图书&quot;

    def __str__(self):
        return self.title
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>adminx.py</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 书籍管理
class BookAdmin(object):
    search_fields = ['title', 'author', 'intro']  # 检索字段
    list_display = ['id', 'show_pic', 'title', 'second_title', 'author', 'translator', 'published_time', 'intro',
                    'tags', 'prizes', 'num', 'sump', 'rate_num']  # 要显示的字段
    list_filter = ['published_time', 'tags', 'prizes']  # 分组过滤的字段
    ordering = ('id',)  # 设置默认排序字段，负号表示降序排序
    list_per_page = 30  # 默认每页显示多少条记录，默认是100条
    model_icon = 'fa fa-book'  # 左侧小图标
    list_editable = ['title', 'author', 'intro', 'published_time']  # 可编辑字段
    style_fields = {'tags': 'm2m_transfer', 'prizes': 'm2m_transfer'}  # 控制字段的显示样式
    filter_horizontal = ('tags', 'prizes')  # 水平选择编辑多对多字段
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>重点是设置style_fields 和filter_horizontal ，效果：</p> <p><img src="https://img-blog.csdnimg.cn/20200621214122315.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h2 id="_89、django后台通过按钮显示textfield字段内容"><a href="#_89、django后台通过按钮显示textfield字段内容" class="header-anchor">#</a> 89、Django后台通过按钮显示TextField字段内容</h2> <p>由于TextField字段类型内容可能很长，在后台显示时很占屏幕位置，可以通过按钮来控制显示，代码如下：
models.py中定义了一个TextField字段类型：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>class Prizes(models.Model):
    name = models.CharField(max_length=32, verbose_name=&quot;奖项&quot;)
    intro = models.TextField(blank=True, null=True, verbose_name='简介')

    class Meta:
        db_table = 'prizes'
        verbose_name = &quot;奖项&quot;
        verbose_name_plural = &quot;奖项&quot;

    def __str__(self):
        return self.name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这里使用xadmin作为后台管理框架，在adminx.py中代码如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import xadmin
from django.utils.safestring import mark_safe
from xadmin import views

from .models import *

# 奖项管理
class PrizesAdmin(object):
    search_fields = ['name']  # 检索字段
    list_display = ['id', 'name', 'show_intro']
    list_filter = ['name']
    ordering = ('id',)

    def show_intro(self, obj):
        # 显示简介
        if not obj.intro:
            return mark_safe('')
        if len(obj.intro) &lt; 20:
            return mark_safe(obj.intro)

        short_id = f'{obj._meta.db_table}_short_text_{obj.id}'
        short_text_len = len(obj.intro) // 4
        short_text = obj.intro[:short_text_len] + '......'
        detail_id = f'{obj._meta.db_table}_detail_text_{obj.id}'
        detail_text = obj.intro

        text = &quot;&quot;&quot;&lt;style type=&quot;text/css&quot;&gt;
                        #%s,%s {padding:10px;border:1px solid green;} 
                  &lt;/style&gt;
                    &lt;script type=&quot;text/javascript&quot;&gt;

                    function openShutManager(oSourceObj,oTargetObj,shutAble,oOpenTip,oShutTip,oShortObj){
                        var sourceObj = typeof oSourceObj == &quot;string&quot; ? document.getElementById(oSourceObj) : oSourceObj;
                        var targetObj = typeof oTargetObj == &quot;string&quot; ? document.getElementById(oTargetObj) : oTargetObj;
                        var shortObj = typeof oShortObj == &quot;string&quot; ? document.getElementById(oShortObj) : oShortObj;
                        var openTip = oOpenTip || &quot;&quot;;
                        var shutTip = oShutTip || &quot;&quot;;
                        if(targetObj.style.display!=&quot;none&quot;){
                           if(shutAble) return;
                           targetObj.style.display=&quot;none&quot;;
                           shortObj.style.display=&quot;block&quot;;
                           if(openTip  &amp;&amp;  shutTip){
                            sourceObj.innerHTML = shutTip; 
                           }
                        } else {
                           targetObj.style.display=&quot;block&quot;;
                           shortObj.style.display=&quot;none&quot;;
                           if(openTip  &amp;&amp;  shutTip){
                            sourceObj.innerHTML = openTip; 
                           }
                        }
                        }
                    &lt;/script&gt;
                    &lt;p id=&quot;%s&quot;&gt;%s&lt;/p&gt;
                    &lt;p&gt;&lt;a href=&quot;###&quot; οnclick=&quot;openShutManager(this,'%s',false,'点击关闭','点击展开','%s')&quot;&gt;点击展开&lt;/a&gt;&lt;/p&gt;

                    &lt;p id=&quot;%s&quot; style=&quot;display:none&quot;&gt;
                       %s
                    &lt;/p&gt;
                    &quot;&quot;&quot; % (short_id, detail_id, short_id, short_text, detail_id, short_id, detail_id, detail_text)
        return mark_safe(text)

    show_intro.short_description = '描述'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p><strong>注意</strong>：复制代码后需要做如下修改：</p> <p><img src="https://img-blog.csdnimg.cn/20200815204246956.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <p>一开始效果</p> <p><img src="https://img-blog.csdnimg.cn/20200621230038819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>点击展开效果：<img src="https://img-blog.csdnimg.cn/20200621230120177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h2 id="_90、前端判断上传的文件是否为图片且限制大小为300kb"><a href="#_90、前端判断上传的文件是否为图片且限制大小为300kb" class="header-anchor">#</a> 90、前端判断上传的文件是否为图片且限制大小为300kB</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en-us&quot;&gt;

&lt;body class=&quot;login&quot;&gt;

&lt;input class=&quot;form-control input-lg&quot; id=&quot;id_icon&quot; name=&quot;icon&quot; type=&quot;file&quot; onchange=&quot;imgTypeSize('id_icon',300)&quot;
&lt;script type=&quot;text/javascript&quot;&gt;
    //判断是否为图片，若为图片，判断其大小是否大于0.3M
    function imgTypeSize(FileId, maxsize) {
        /*获取图片内容对象*/
        var imgFile = document.getElementById(FileId).files[0];
        if (imgFile.name == &quot;&quot;) {
            alert(&quot;请上传头像哦&quot;);
            return false;
        } else {
            /*图片类型正则验证*/
            var imgStr = /\.(jpg|jpeg|png|bmp|BMP|JPG|PNG|JPEG)$/;
            if (!imgStr.test(imgFile.name)) {
                alert(&quot;文件不是图片类型&quot;);
                return false;
            } else {
                /*图片大小*/
                var imagSize = imgFile.size;
                if (imagSize &lt; (1024 * maxsize)) {
                    return true;
                } else {
                    alert(imgFile.name + &quot;大小不能超过&quot; + maxsize + &quot;kB&quot;);
                    document.getElementById(FileId).value = &quot;&quot;
                    return false;
                }
            }
        }
    }


&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="_91、form表单提交前验证"><a href="#_91、form表单提交前验证" class="header-anchor">#</a> 91、form表单提交前验证</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;form action=&quot;&quot; method=&quot;post&quot; id=&quot;login-form&quot; onsubmit=&quot;return toVaild()&quot;&gt;
	&lt;input class=&quot;form-control&quot; id=&quot;id_account&quot; name=&quot;account&quot; type=&quot;text&quot; placeholder=&quot;账号&quot;/&gt;
	&lt;input class=&quot;form-control&quot; id=&quot;id_password&quot; name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;密码&quot;&gt;
&lt;form&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
    document.getElementById('id_username').focus()

    function toVaild() {
        var account = document.getElementById(&quot;id_account&quot;).value;
        var password = document.getElementById(&quot;id_password&quot;).value;
        if (account == &quot;&quot; || password == &quot;&quot;) {
            alert(&quot;请输入账号和密码&quot;);
            return false;
        } else {
            return true;
        }
    }
&lt;/script&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_92、有序字典"><a href="#_92、有序字典" class="header-anchor">#</a> 92、有序字典</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import collections

d1 = collections.OrderedDict()  # 创建一个有序字典
d1['a'] = 'A'
d1['b'] = 'B'
d1['c'] = 'C'
d1['d'] = 'D'
for k, v in d1.items():
    print(k, v)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_93、python在windows系统下实现tts-文字转语音"><a href="#_93、python在windows系统下实现tts-文字转语音" class="header-anchor">#</a> 93、Python在Windows系统下实现TTS（文字转语音）</h2> <p>导入包：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip install pypiwin32

import win32com.client
spk = win32com.client.Dispatch(&quot;SAPI.SpVoice&quot;)
spk.Speak(u&quot;my name is ldc,what is your name&quot;)
spk.Speak(u&quot;大家好&quot;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_94、定义一个简单闹钟"><a href="#_94、定义一个简单闹钟" class="header-anchor">#</a> 94、定义一个简单闹钟</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># pip install pypiwin32 -i https://pypi.python.org/simple
import win32com.client
import time 
import winsound

spk = win32com.client.Dispatch(&quot;SAPI.SpVoice&quot;)
# 定义闹钟时间
clocktime = [[19, 19], [11, 10], [12, 10], [18, 47]]  
runinghour = 1  # 定义运行时间
times = runinghour * 3600  # 次数
print(times)
for i in range(1, times):
    time_now = [time.localtime(time.time()).tm_hour, time.localtime(time.time()).tm_min]
    if time_now in clocktime:
        print(time_now)
        winsound.Beep(1000, 1000)
        spk.Speak(u&quot;快去看下饭好了没有？&quot;)
    time.sleep(60)  # 每分钟对比一次时间
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_95、根据年月获取当月天数"><a href="#_95、根据年月获取当月天数" class="header-anchor">#</a> 95、根据年月获取当月天数</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>def get_month_days(year, month):
    &quot;&quot;&quot;
    根据年份，月份信息显示此月份天数
    :param year: 年份：
    :param month: 月份（1～12）：
    :return: 当月天数
    &quot;&quot;&quot;
    if month &gt;12 or month &lt;= 0:
        return -1
    if month == 2:
        return 29 if year % 4 == 0 and year % 100 != 0 or year % 400 == 0 else 28

    if month in (4, 6, 9, 11):
        return 30
    else:
        return 31

a = '2020-04'.split('-')
year = int(a[0])
month = int(a[1])
print(get_month_days(year,month))

输出：
30
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_96、django获取favicon-ico图标"><a href="#_96、django获取favicon-ico图标" class="header-anchor">#</a> 96、Django获取favicon.ico图标</h2> <p>制作一个ico文件，使用PS或者某些在线生成ico的网站</p> <p>将此文件命名为“favicon.ico”后放在static/下</p> <p><img src="https://img-blog.csdnimg.cn/20200805104730363.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>在urls.py中定义路由：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>from django.urls import path
from django.views.generic import RedirectView

urlpatterns = [
	# 访问favicon.ico 网站图标
    path(&quot;favicon.ico&quot;,RedirectView.as_view(url='static/favicon.ico')),

]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_97、django-静态文件配置"><a href="#_97、django-静态文件配置" class="header-anchor">#</a> 97、django 静态文件配置</h2> <p>settings.py</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    STATIC_URL = '/static/'
    # 添加静态资源路由地址
    STATICFILES_DIRS = [
        os.path.join(BASE_DIR, 'static'),
    
    ]
    # 使用python manage.py collectstatic收集静态文件时时使用STATIC_ROOT
    # STATIC_ROOT = os.path.join(BASE_DIR, 'static')

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>urls.py</p> <div class="language- extra-class"><pre><code>from django.urls import path, re_path
from django.views.generic import RedirectView
from django.views.static import serve

from '你的项目名称' import settings
urlpatterns = [
   
    path(&quot;favicon.ico&quot;,RedirectView.as_view(url='static/favicon.ico')),
    re_path('static/(?P&lt;path&gt;.*)$', serve, {'document_root': settings.STATICFILES_DIRS[0]}),
    
]
</code></pre></div><h2 id="_98、django-jsonresponse返回中文时显示unicode编码-u67e5-u8be2"><a href="#_98、django-jsonresponse返回中文时显示unicode编码-u67e5-u8be2" class="header-anchor">#</a> 98、django JsonResponse返回中文时显示unicode编码（\u67e5\u8be2）</h2> <p>原因
这个unicode编码，是python3默认返回的编码。</p> <p>解决方案
JsonResponse里面有个参数json_dumps_params，设置为json_dumps_params={‘ensure_ascii’:False}即可。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    data = {'msg': '创建成功',}
    return JsonResponse(data=data, json_dumps_params={'ensure_ascii': False})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_99、获取当前时间月份的首日与最后一天"><a href="#_99、获取当前时间月份的首日与最后一天" class="header-anchor">#</a> 99、获取当前时间月份的首日与最后一天</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import calendar

def get_month_start_and_end(date=datetime.datetime.now()):
    &quot;&quot;&quot;
    获取当前时间的月份首日与最后一天
    :param date:
    :return: (首日，最后一天)
    &quot;&quot;&quot;
    year, month = str(date).split('-')[0], str(date).split('-')[1]
    end = calendar.monthrange(int(year), int(month))[1]
    return f'{year}-{month}-01', f'{year}-{month}-{end}'

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_100、xadmin后台批量操作"><a href="#_100、xadmin后台批量操作" class="header-anchor">#</a> 100、xadmin后台批量操作</h2> <p>adminx.py</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import xadmin
from django.db.models import  Sum
from xadmin.plugins.actions import BaseActionView

class MyCountFeeAction(BaseActionView):
    &quot;&quot;&quot;
        用户余额统计
        &quot;&quot;&quot;
    action_name = &quot;countuserfee&quot;  #: 相当于这个 Action 的唯一标示, 尽量用比较针对性的名字
    description = u'统计用户总余额'  #: 描述, 出现在 Action 菜单中, 可以使用 ``%(verbose_name_plural)s`` 代替 Model 的名字.
    model_perm = 'view'  # 权限

    def do_action(self, queryset):
        all_balance = MallUser.objects.all().aggregate(Sum('balance'))
        return HttpResponse(f'用户总余额{all_balance}')
class UserAdmin(object):
    &quot;&quot;&quot;用户信息管理&quot;&quot;&quot;
    list_display = ['username', 'balance', 'status', 'addtime']
    search_fields = ['username', ]
    list_filter = ['status', 'addtime']
    list_per_page = 30  # 默认每页数量
    model_icon = 'fa fa-user'
    list_editable = ['status']
    ordering = ['-addtime']
    actions = [ MyCountFeeAction]  # 添加批量选择操作
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/20200812233442373.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <h2 id="_101、xadmin过滤器外键显示特定值-比如只能过滤自己与超级管理员定义的数据"><a href="#_101、xadmin过滤器外键显示特定值-比如只能过滤自己与超级管理员定义的数据" class="header-anchor">#</a> 101、xadmin过滤器外键显示特定值（比如只能过滤自己与超级管理员定义的数据）</h2> <p>首先，修改xadmin源码，修改xadmin/filters.py,在401行，做如下修改，</p> <div class="language- extra-class"><pre><code>把self.lookup_choices = field.get_choices(include_blank=False)
改为：

# 调用自定义的方法
if hasattr(model_admin, '{field}_choices'.format(field=field.name)):
        self.lookup_choices = getattr(model_admin, '{field}_choices'.format(field=field.name))(field, request,params, model,model_admin,field_path)
    else:
        self.lookup_choices = field.get_choices(include_blank=False)
</code></pre></div><p>如图:</p> <p><img src="https://img-blog.csdnimg.cn/20200812234011656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <p>然后，在adminx.py中定义过滤的方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import xadmin
from django.db.models import  Q, Sum
from xadmin.plugins.actions import BaseActionView

class MeasurePointAdmin(object):
    # search_fields = ['user__name', 'user__account']  # 检索字段
    list_display = ['num', 'elevation', 'correct_num', 'cumulative_amount']
    list_filter = ['user', 'is_default', 'create_time']  # 分组过滤的字段
    list_editable = ['num', 'elevation', 'correct_num', 'cumulative_amount']
    ordering = ('id',)  # 设置默认排序字段，负号表示降序排序
    list_per_page = 30  # 默认每页显示多少条记录，默认是100条
    model_icon = 'fa fa-users'  # 左侧小图标
    readonly_fields = ['user', 'is_default']
    import_excel = True
    actions = [MyCountFeeAction]
	
	# 定义的函数名必须是  字段名_choices
    def user_choices(self, field, request, params, model, model_admin, field_path):
        # 超级用户不做控制
        if self.request.user.is_superuser:
            return field.get_choices(include_blank=False)

        # 过滤器只显示自己与超级管理员
        user_lst = field.related_model._default_manager.filter(Q(id=self.request.user.id) | Q(is_superuser=True))
        # 返回格式 [('pk','标题'),]
        return [(user.id, user.username) for user in user_lst]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>效果:</p> <p><img src="https://img-blog.csdnimg.cn/2020081223440761.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xtX2lzX2Rj,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <h2 id="_102、django中的csrf局部禁用"><a href="#_102、django中的csrf局部禁用" class="header-anchor">#</a> 102、Django中的CSRF局部禁用</h2> <p>为了避免没有csrf token而产生的403的forbidden错误，可以使用csrf_exempt装饰器来处理POST、GET请求的View, 这种方式是CSRF局部禁用。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>from django.utils.decorators import method_decorator
from django.views.decorators.csrf import csrf_exempt

@method_decorator(csrf_exempt)
def update_data(request):
    if request.method == 'POST':
    	pass
	elif request.method == 'GET':
    	pass

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_103、使用python命令创建django项目"><a href="#_103、使用python命令创建django项目" class="header-anchor">#</a> 103、使用python命令创建django项目</h2> <p>创建django项目
方式一：直接打开pycharm创建，选择file-&gt;new project-&gt;django
方式二：通过命令创建
先创建虚拟环境：python -m venv django_venv
然后导入django库：pip install django -i https://pypi.tuna.tsinghua.edu.cn/simple
最后使用命令创建：django-admin startproject my_django_project</p> <h2 id="_104、-二维列表、二维数组行求和与列求和"><a href="#_104、-二维列表、二维数组行求和与列求和" class="header-anchor">#</a> 104、 二维列表、二维数组行求和与列求和</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import pandas as pd
from functools import reduce

# 二维数组，对列和行求和
a = [
    ['', 0, '', 1, 4.1],
    ['', 0, '', '', 4],
    ['123', 0, '', 3, 4, 6,7],
]


def aa(x, y):
    x = 0 if isinstance(x, str) else x
    y = 0 if isinstance(y, str) else y
    return x + y

# 对行求和
row_sum = [reduce(aa, i) for i in a]
# 对列求和，只能处理相同长度的子元素
column_sum_1 = [reduce(aa, i) for i in zip(*a)]
# 对列求和，可以处理不同长度的子元素
column_sum_2 = list(dict(pd.DataFrame(a).fillna(0).apply(lambda x: '' if any(isinstance(d, str) for d in x) else round(x.sum(), 2))).values())
print('行求和：{}\r\n列求和(相同长度)：{}\r\n列求和：{}'.format(row_sum, column_sum_1, column_sum_2))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>行求和：[5.1, 4, 20]
列求和(相同长度)：[0, 0, 0, 4, 12.1]
列求和：['', 0, '', '', 12.1, 6.0, 7.0]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_105、获取时间字符串的月份数"><a href="#_105、获取时间字符串的月份数" class="header-anchor">#</a> 105、获取时间字符串的月份数</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>from datetime import datetime
    
def get_months(start_month_str, end_month_str):
    '''
    # 获取时间字符串中的月份数
    :param start_month_str: 开始字符串
    :param end_month_str: 结束字符串
    :return: 月份数
    '''

    end_month_date = datetime.strptime(end_month_str, '%Y-%m')
    start_month_date = datetime.strptime(start_month_str, '%Y-%m')
    end_year, end_month = end_month_date.year, end_month_date.month
    start_year, start_month = start_month_date.year, start_month_date.month

    return (end_year - start_year) *12 + (end_month - start_month) + 1


end_month_str = '2021-02'
start_month_str = '2020-07'
print(get_months(start_month_str, end_month_str))

输出：

8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="_106、字符串不足补零"><a href="#_106、字符串不足补零" class="header-anchor">#</a> 106、字符串不足补零</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>print('hello world'.zfill(15)) # 补0
print('hello world'.rjust(15)) # 右对齐，补空格
print('hello world'.ljust(15)) # 左对齐，补空格

输出：

0000hello world
    hello world
hello world  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_107、时间戳转字符串日期"><a href="#_107、时间戳转字符串日期" class="header-anchor">#</a> 107、时间戳转字符串日期</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> time
t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

输出：
<span class="token number">1621741567.082192</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">23</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">07</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>使用函数：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># !/usr/bin/python
# -*- coding: utf-8 -*-

&quot;&quot;&quot;
@contact: 微信 1257309054
@file: 时间戳转日期.py
@time: 2022/6/27 17:16
@author: LDC
&quot;&quot;&quot;
import time
import datetime


# 正确10位长度的时间戳可精确到秒，11-14位长度则是包含了毫秒
def int_to_datetime(intValue):
    if len(str(intValue)) == 10:
        # 精确到秒
        timeValue = time.localtime(intValue)
        tempDate = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, timeValue)
        datetimeValue = datetime.datetime.strptime(tempDate, &quot;%Y-%m-%d %H:%M:%S&quot;)
    elif 10 &lt; len(str(intValue)) and len(str(intValue)) &lt; 15:
        # 精确到毫秒
        k = len(str(intValue)) - 10
        timetamp = datetime.datetime.fromtimestamp(intValue / (1 * 10 ** k))
        datetimeValue = timetamp.strftime(&quot;%Y-%m-%d %H:%M:%S.%f&quot;)
    else:
        return -1
    return datetimeValue


time1 = 1656321420
time2 = 1656321086560
print(int_to_datetime(time1))
print(int_to_datetime(time2))

'''
输出：
2022-06-27 17:17:00
2022-06-27 17:11:26.560000
'''
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="_108、列表转字符串"><a href="#_108、列表转字符串" class="header-anchor">#</a> 108、列表转字符串</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

输出：
`<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span>`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_109、pip国内镜像源"><a href="#_109、pip国内镜像源" class="header-anchor">#</a> 109、pip国内镜像源</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip install 库名 -i https://pypi.tuna.tsinghua.edu.cn/simple


清华：-i https://pypi.tuna.tsinghua.edu.cn/simple

阿里云：-i http://mirrors.aliyun.com/pypi/simple/

中国科技大学 -i https://pypi.mirrors.ustc.edu.cn/simple/

华中理工大学：-i http://pypi.hustunique.com/

山东理工大学：-i http://pypi.sdutlinux.org/ 

豆瓣：-i http://pypi.douban.com/simple/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_110、python把时间字符串转换成刚刚、1天前、3个月前、1年前"><a href="#_110、python把时间字符串转换成刚刚、1天前、3个月前、1年前" class="header-anchor">#</a> 110、python把时间字符串转换成刚刚、1天前、3个月前、1年前</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import datetime
import time


def date_interval(date_str):
    '''
    获取时间间隔
    1分钟前，2分钟前，10分钟前，1小时前，2小时前，1天前，2天前，3天前，1个月前，3个月前，1年前，3年前
    :param date_str: 时间字符串
    :return: 字符串
    '''
    date_str = time.strptime(date_str, '%Y-%m-%d %H:%M:%S')
    # 将时间元组转换为时间戳
    t = time.mktime(date_str)

    # 当前时间
    seconds = time.time() - t

    years = int(seconds // (60 * 60 * 24 * 365))
    if years:
        return '{}年前'.format(years)
    months = int(seconds // (60 * 60 * 24 * 30))
    if months:
        return '{}月前'.format(months)
    days = int(seconds // (60 * 60 * 24))
    if days:
        return '{}天前'.format(days)
    hours = int(seconds // (60 * 60))
    if hours:
        return '{}小时前'.format(hours)
    minutes = int(seconds // (60))
    if minutes:
        return '{}分钟前'.format(minutes)
    return '刚刚'


if __name__ == '__main__':
    date1 = '2019-07-10 15:27:51'
    date2 = '2021-07-10 15:27:51'
    date3 = '2021-08-10 15:27:51'
    date4 = '2021-08-12 11:01:51'
    date5 = datetime.datetime.now() + datetime.timedelta(seconds=-3)
    date5 = date5.strftime('%Y-%m-%d %H:%M:%S')
    print(date_interval(date1))
    print(date_interval(date2))
    print(date_interval(date3))
    print(date_interval(date4))
    print(date_interval(date5))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><h2 id="_111、django使用orm执行sql语句"><a href="#_111、django使用orm执行sql语句" class="header-anchor">#</a> 111、Django使用ORM执行sql语句</h2> <p>通过raw函数执行</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>alarm_datas = gsm.AlertMessage.objects.raw('''
                select am_all.id, am_all.sensor_number
                    FROM alert_message as am_all
                    where 
                        am_all.real='1'
                        and am_all.is_show=1
                    order by am_all.alarm_level desc
                ''')
for ad in alarm_datas:
	print(ad.sensor_number)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_112、django通过变量字段获取数据"><a href="#_112、django通过变量字段获取数据" class="header-anchor">#</a> 112、Django通过变量字段获取数据</h2> <p>通过方法<code>__getattribute__</code>来获取</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>alert_messages = AlertMessage.objects.filter(real=0)
am_fields = ['id', 'real', 'name']
for am in alert_messages:
	for i in range(len(am_fields)):
		print(am_fields[i], am.__getattribute__(am_fields[i]))

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_113、django查询变量字段、更新变量字段"><a href="#_113、django查询变量字段、更新变量字段" class="header-anchor">#</a> 113、Django查询变量字段、更新变量字段</h2> <p>通过<code>**{变量名:值}</code>来操作</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>field = 'device_code'
# 查询
device_infos = gsm.DeviceInfo.objects.filter(**{field: '012'})
# 更新
gsm.DeviceInfo.objects.filter(device_code='012').update(**{field : '0'})

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_114、vue生成dist文件"><a href="#_114、vue生成dist文件" class="header-anchor">#</a> 114、vue生成dist文件</h2> <p>安装npm，到<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener noreferrer">官网下载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
在vue项目下打开cmd，输入命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm run build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果报错，npm ERR! missing script: build，
则使用以下命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm run build:prod
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>具体看package.json</p> <p><img src="https://img-blog.csdnimg.cn/eff15dcd4c1d499f9641d0ac25c09bc0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5Lic5pyo5pyI,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <h2 id="_115、python获取电脑磁盘、cpu、内存使用情况"><a href="#_115、python获取电脑磁盘、cpu、内存使用情况" class="header-anchor">#</a> 115、python获取电脑磁盘、CPU、内存使用情况</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>import psutil
#  pip install psutil

# 获取本机磁盘使用率和剩余空间G信息
def get_disk_info():
    # 循环磁盘分区
    content = &quot;&quot;
    for disk in psutil.disk_partitions():
        # 读写方式 光盘 or 有效磁盘类型
        if 'cdrom' in disk.opts or disk.fstype == '':
            continue
        disk_name_arr = disk.device.split(':')
        disk_name = disk_name_arr[0]
        disk_info = psutil.disk_usage(disk.device)
        # 磁盘剩余空间，单位G
        free_disk_size = disk_info.free//1024//1024//1024
        # 当前磁盘使用率和剩余空间G信息
        info = &quot;{}盘使用率：{}%%， 剩余空间：{}G &quot;.format(disk_name, str(disk_info.percent), free_disk_size)
        # 拼接多个磁盘的信息
        content = content + info
    print(content)

# cpu信息
def get_cpu_info():
    cpu_percent = psutil.cpu_percent(interval=1)
    cpu_info = &quot;CPU使用率：%i%%&quot; % cpu_percent
    print(cpu_info)

# 内存信息
def get_memory_info():
    virtual_memory = psutil.virtual_memory()
    used_memory = virtual_memory.used/1024/1024/1024
    free_memory = virtual_memory.free/1024/1024/1024
    memory_percent = virtual_memory.percent
    memory_info = &quot;内存使用：%0.2fG，使用率%0.1f%%，剩余内存：%0.2fG&quot; % (used_memory, memory_percent, free_memory)
    print(memory_info)

if __name__ == '__main__':
    get_disk_info()
    get_cpu_info()
    get_memory_info()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="_116、max比较字典列表"><a href="#_116、max比较字典列表" class="header-anchor">#</a> 116、max比较字典列表</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>'''
使用max函数比较字典列表对象
需求：找出用户组最大id的字典
'''
def com_id(f):
    '''
    比较用用户ids列表
    :param f: 字典
    :return: 返回最大的用户id
    '''
    return max(f['user_ids'])

friends_added = [
        {'user_ids': [1, 2], 'create_at': '2020-01-01'},
        {'user_ids': [3, 6], 'create_at': '2020-01-02'},
        {'user_ids': [2, 1], 'create_at': '2020-02-02'},
        {'user_ids': [4, 1], 'create_at': '2020-02-02'},
    ]
# max函数中使用key参数，指定自定义函数来比较
item = max(friends_added, key=com_id)
item_1 = max(friends_added, key=lambda f: max(f['user_ids'])) # com_id可以转成lambda函数
print(item)
print(item_1)


输出：

{'user_ids': [3, 6], 'create_at': '2020-01-02'}
{'user_ids': [3, 6], 'create_at': '2020-01-02'}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_117、django查询表的具体字段"><a href="#_117、django查询表的具体字段" class="header-anchor">#</a> 117、django查询表的具体字段</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>ExampleModel.objects.values('id', 'username')
# 返回的结果是QuerySet， 里面的元素是dict格式
# [{'id':1, 'username': 'Austin'}, {'id':2, 'username':'Sam'}, ...]
# 相当于SQL中的SELECT id, username FROM ......, 
# 只返回对应属性（字段）的值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_118、mysql查询数据添加自增序号"><a href="#_118、mysql查询数据添加自增序号" class="header-anchor">#</a> 118、MySQL查询数据添加自增序号</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>set @i = 0;
select waveform, '沿桥风吹' as label ,(@i:=@i+1) xh from alert_message where is_real=1 and node_id=138

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_119、mysql-时间截取年月日"><a href="#_119、mysql-时间截取年月日" class="header-anchor">#</a> 119、MySQL 时间截取年月日</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>select id,
			addtime, 
			date_format(addtime,'%Y-%m-%d') as short_time 
	from alert_message 
	where date_format(addtime,'%Y-%m-%d') = '2022-03-13'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/37cec67fa1e1458f9aba1b745600a493.png" alt="在这里插入图片描述"></p> <h2 id="_120、-列表取奇数下标值"><a href="#_120、-列表取奇数下标值" class="header-anchor">#</a> 120、 列表取奇数下标值</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>list1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'奇数下标值'</span><span class="token punctuation">,</span>list1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

输出：

奇数下标值 <span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_121、列表取偶数下标值"><a href="#_121、列表取偶数下标值" class="header-anchor">#</a> 121、列表取偶数下标值</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>list1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'偶数下标值'</span><span class="token punctuation">,</span>list1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
偶数下标值 <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_122、列表相同元素分类、分组"><a href="#_122、列表相同元素分类、分组" class="header-anchor">#</a> 122、列表相同元素分类、分组</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> itertools

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span>
a <span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span> <span class="token keyword">for</span> key<span class="token punctuation">,</span> group <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

输出：

<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_123、ubuntu切换用户"><a href="#_123、ubuntu切换用户" class="header-anchor">#</a> 123、ubuntu切换用户</h2> <p>1）从user用户切换到root用户
sudo su
2）从root用户切回user用户
su user (user是你自己安装时候的用户名)，或是直接输入exit，也可Ctrl+D组合键推出</p> <h2 id="_124、numpy二维数组获取某一列"><a href="#_124、numpy二维数组获取某一列" class="header-anchor">#</a> 124、numpy二维数组获取某一列</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

a <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">13.2</span><span class="token punctuation">,</span> <span class="token number">14.8</span><span class="token punctuation">,</span> <span class="token number">15.9</span><span class="token punctuation">,</span> <span class="token number">16.10</span><span class="token punctuation">,</span> <span class="token number">16.11</span><span class="token punctuation">,</span> <span class="token number">17.12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

a_np <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment"># 把二维列表转成numpy数组</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第一行'</span><span class="token punctuation">,</span> a_np<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 获取第一行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第一列'</span><span class="token punctuation">,</span> a_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 获取第一列</span>

输出：

第一行 <span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">6.0</span><span class="token punctuation">]</span>
第一列 <span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">7.0</span><span class="token punctuation">,</span> <span class="token number">13.2</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/xugaoyi/vuepress-theme-vdoing/edit/master/docs/40.技术/02.collection/01.python组件.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/09/07, 21:52:33</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/61a72b/"><div>
            Listening
            <!----></div></a> <span class="date">09-07</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f53b6b/"><div>
            软件安装
            <!----></div></a> <span class="date">09-07</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/0b8e30/"><div>
            me
            <!----></div></a> <span class="date">09-07</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:981815087@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Li-Jennifer" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>Jennifer | <a href="https://github.com/Li-Jennifer" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.55777c8e.js" defer></script><script src="/assets/js/2.f1cfd21b.js" defer></script><script src="/assets/js/45.d04ed2a7.js" defer></script>
  </body>
</html>
